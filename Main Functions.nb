(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    144266,       3536]
NotebookOptionsPosition[    135272,       3433]
NotebookOutlinePosition[    135615,       3448]
CellTagsIndexPosition[    135572,       3445]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"First", ",", " ", 
   RowBox[{"clear", " ", "everything", " ", 
    RowBox[{"up", "."}]}]}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.7848148113466463`*^9, 3.784814822709523*^9}, {
   3.7848148755839176`*^9, 3.7848149685773654`*^9}, {3.784815731909584*^9, 
   3.784815756733798*^9}, 3.7983187736693172`*^9},
 CellLabel->"In[1]:=",ExpressionUUID->"d0de7dd1-7b12-4b8b-af6c-56973703c3e0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "coneandcollapse", ",", "lookup", ",", "flagcplx", ",", "flagdim", ",", 
    "fullflagcplx", ",", "sublistQ", ",", "sublists", ",", "simpdim", ",", 
    "simplices", ",", "simpcrank", ",", "simpboundary", ",", "simprank", ",", 
    "simpbetti", ",", "simptorsion", ",", "nsimprank", ",", "nsimpbetti", ",",
     "simphomology", ",", "nsimphomology", ",", "maximalfaces", ",", 
    "maximalfaceabove", ",", "abovetally", ",", "nmaxfacesabove", ",", 
    "freefaces", ",", "findfreeface", ",", "collapse", ",", "seqcollapse", 
    ",", "findgoodcycles", ",", "findgoodcomponents", ",", "pop", ",", "cone",
     ",", "uniqueindices", ",", "seqcollapsibleQ", ",", "nullspace", ",", 
    "selectcells", ",", "popeverything", ",", "vlookup", ",", "vertices", ",",
     "lower", ",", "upper", ",", "lowerelookup", ",", "upperelookup", ",", 
    "flagtplx", ",", "tdim", ",", "fullflagtplx", ",", "sdeg", ",", "globdir",
     ",", "sdim", ",", "locdir", ",", "c3dir", ",", "tsimpdim", ",", 
    "subtournscodim1", ",", "tsimplices", ",", "tsimplicespositive", ",", 
    "tsimpcrank", ",", "tsimpboundary", ",", "tsimprank", ",", "tsimpbetti", 
    ",", "tsimptorsion", ",", "ntsimprank", ",", "ntsimpbetti", ",", 
    "tsimphomology", ",", "ntsimphomology", ",", "locfiltration", ",", 
    "c3filtration", ",", "bifiltration", ",", "bdryrank", ",", "chcxbetti", 
    ",", "chcxtorsion", ",", "fulltsimpboundary", ",", "low", ",", "pairing", 
    ",", "pHcol", ",", "locfilt", ",", "locsort", ",", "locpers"}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.7848149835183415`*^9, 3.7848149906103497`*^9}, {
   3.7848150438352757`*^9, 3.784815052328229*^9}, {3.7848158036644545`*^9, 
   3.784815804412692*^9}, {3.7848167988367023`*^9, 3.7848168955094004`*^9}, {
   3.7848171000916634`*^9, 3.784817100292381*^9}, {3.78481842845133*^9, 
   3.784818431226288*^9}, {3.7848195819607778`*^9, 3.7848196139707155`*^9}, {
   3.784839540016423*^9, 3.784839543132615*^9}, {3.7981299414635315`*^9, 
   3.798129942755018*^9}, {3.7981300264092927`*^9, 3.798130062209847*^9}, {
   3.7981301009059296`*^9, 3.798130101244875*^9}, {3.7982335590267763`*^9, 
   3.798233564172798*^9}, {3.7982336363500175`*^9, 3.798233643098095*^9}, {
   3.7983184264390635`*^9, 3.7983184512908297`*^9}, {3.798363551148305*^9, 
   3.798363578107893*^9}, {3.7983639668232994`*^9, 3.798363967125723*^9}, {
   3.79836407124863*^9, 3.7983640732712097`*^9}, 3.79836411774259*^9, 
   3.7983645452549486`*^9, {3.7983663041913996`*^9, 3.7983663459740195`*^9}, {
   3.7983663794519515`*^9, 3.7983663903185425`*^9}, {3.7983664265977263`*^9, 
   3.7983664344993324`*^9}, {3.7983749880570474`*^9, 
   3.7983749971577244`*^9}, {3.79837807767596*^9, 3.7983780778935704`*^9}, {
   3.7983835961834755`*^9, 3.7983836397922387`*^9}, {3.798749077923278*^9, 
   3.79874907833673*^9}, {3.7989162628562984`*^9, 3.7989162718159003`*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"0968a459-b601-484c-934e-c37a2ad72515"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{
   "Define", " ", "directed", " ", "flag", " ", "complexes", " ", "of", " ", 
    "directed", " ", "graphs"}], ",", " ", 
   RowBox[{
   "using", " ", "a", " ", "procedure", " ", "inspired", " ", "by", " ", 
    "the", " ", "Flagser", " ", 
    RowBox[{"algorithm", ".", " ", "A"}], " ", "directed", " ", "graph", " ", 
    "is", " ", "given", " ", "by", " ", "its", " ", "list", " ", "of", " ", 
    "edges", " ", 
    RowBox[{"e", ".", " ", "Edges"}], " ", "are", " ", "pairs", " ", "whose", 
    " ", "first", " ", "component", " ", "is", " ", "the", " ", "initial", 
    " ", "vertex", " ", "and", " ", "second", " ", "component", " ", "is", 
    " ", "the", " ", "terminal", " ", 
    RowBox[{"vertex", ".", " ", "The"}], " ", "simplices", " ", "of", " ", 
    "the", " ", "flag", " ", "complex", " ", "are", " ", "computed", " ", 
    "in", " ", "each", " ", "dimension", " ", "separately", " ", "and", " ", 
    "given", " ", "as", " ", "ordered", " ", 
    RowBox[{"lists", "."}]}]}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.784816944899376*^9, 3.784816963250379*^9}, {
  3.7848182758740644`*^9, 3.784818293761612*^9}, {3.784818679796635*^9, 
  3.784818683631465*^9}, {3.784818779614667*^9, 3.7848189208895264`*^9}, {
  3.7983637190969276`*^9, 3.798363723300221*^9}},
 CellLabel->"In[3]:=",ExpressionUUID->"d3d0c678-1fd7-4665-91d2-f07568139f40"],

Cell[BoxData[
 RowBox[{
  RowBox[{"lookup", "[", "e_", "]"}], ":=", 
  RowBox[{
   RowBox[{"lookup", "[", "e", "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Last", "/@", "#"}], "&"}], "/@", 
    RowBox[{"GroupBy", "[", 
     RowBox[{
      RowBox[{"Union", "[", "e", "]"}], ",", "First"}], "]"}]}]}]}]], "Input",
 CellLabel->"In[4]:=",ExpressionUUID->"d2fb68bd-da7f-4bd8-9c73-f82da60857e5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"flagcplx", "[", 
   RowBox[{"e_", ",", 
    RowBox[{"-", "1"}]}], "]"}], ":=", 
  RowBox[{
   RowBox[{"flagcplx", "[", 
    RowBox[{"e", ",", 
     RowBox[{"-", "1"}]}], "]"}], "=", 
   RowBox[{"{", "}"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"flagcplx", "[", 
   RowBox[{"e_", ",", "0"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"flagcplx", "[", 
    RowBox[{"e", ",", "0"}], "]"}], "=", 
   RowBox[{"Transpose", "[", 
    RowBox[{"{", 
     RowBox[{"Union", "@@", "e"}], "}"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"flagcplx", "[", 
   RowBox[{"e_", ",", "1"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"flagcplx", "[", 
    RowBox[{"e", ",", "1"}], "]"}], "=", 
   RowBox[{"Union", "[", "e", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"flagcplx", "[", 
   RowBox[{"e_", ",", "i_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"flagcplx", "[", 
    RowBox[{"e", ",", "i"}], "]"}], "=", 
   RowBox[{"Union", "@@", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Thread", "[", 
       RowBox[{"Append", "[", 
        RowBox[{"s", ",", 
         RowBox[{"Intersection", "@@", 
          RowBox[{"Lookup", "[", 
           RowBox[{
            RowBox[{"lookup", "[", "e", "]"}], ",", "s", ",", 
            RowBox[{"{", "}"}]}], "]"}]}]}], "]"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"s", ",", 
        RowBox[{"flagcplx", "[", 
         RowBox[{"e", ",", 
          RowBox[{"i", "-", "1"}]}], "]"}]}], "}"}]}], "]"}]}]}]}]}], "Input",
 CellChangeTimes->{{3.7359852244473734`*^9, 3.7359852810978017`*^9}, {
   3.7359853300899997`*^9, 3.735985363813896*^9}, {3.735985478231626*^9, 
   3.735985655917031*^9}, {3.7359857048702106`*^9, 3.7359857835386963`*^9}, 
   3.7359860189647493`*^9, {3.735986050489874*^9, 3.735986055254437*^9}, {
   3.7359861403834515`*^9, 3.7359861404040513`*^9}, {3.7359861747260523`*^9, 
   3.7359861769528437`*^9}, {3.7359867885724745`*^9, 3.735986798628337*^9}, {
   3.735988682545332*^9, 3.7359886959365015`*^9}, {3.778090729510912*^9, 
   3.7780907296732883`*^9}, {3.7780908643082223`*^9, 
   3.7780908654870195`*^9}, {3.778091270636743*^9, 3.778091319342644*^9}, 
   3.7780917020819936`*^9, {3.7780919477313952`*^9, 3.7780919584885635`*^9}, {
   3.7780969406631956`*^9, 3.778096956062518*^9}, {3.7780988978110943`*^9, 
   3.7780989242362566`*^9}, 3.7780996327094383`*^9, 3.778099902942418*^9, 
   3.7781009224804897`*^9, {3.7781020022391605`*^9, 3.7781020051594133`*^9}, {
   3.77810337857193*^9, 3.7781033830752993`*^9}, {3.7781035545757036`*^9, 
   3.778103557331128*^9}, {3.7986129333028016`*^9, 3.79861293662842*^9}},
 CellLabel->"In[5]:=",ExpressionUUID->"87dea68a-4aaa-465e-a8c6-004799ceaac1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"flagdim", "[", "e_", "]"}], ":=", 
  RowBox[{
   RowBox[{"flagdim", "[", "e", "]"}], "=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"i", "=", "0"}], "}"}], ",", 
     RowBox[{
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"flagcplx", "[", 
          RowBox[{"e", ",", "i"}], "]"}], "\[NotEqual]", 
         RowBox[{"{", "}"}]}], ",", 
        RowBox[{"i", "++"}]}], "]"}], ";", 
      RowBox[{"Return", "[", 
       RowBox[{"i", "-", "1"}], "]"}]}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.735986270721531*^9, 3.7359863450767183`*^9}, {
   3.7359877229987497`*^9, 3.73598772342315*^9}, 3.736259091192816*^9, {
   3.7362591272123594`*^9, 3.736259128619852*^9}, {3.7513716869001036`*^9, 
   3.7513716878693914`*^9}, {3.7537875669811525`*^9, 3.753787568762558*^9}, {
   3.784817066537592*^9, 3.7848170689563336`*^9}},
 CellLabel->"In[9]:=",ExpressionUUID->"9aa47d56-60e6-49fa-b87a-0d32be7bb6e8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"fullflagcplx", "[", "e_", "]"}], ":=", 
  RowBox[{
   RowBox[{"fullflagcplx", "[", "e", "]"}], "=", 
   RowBox[{"Union", "@@", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"flagcplx", "[", 
       RowBox[{"e", ",", "i"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "0", ",", 
        RowBox[{"flagdim", "[", "e", "]"}]}], "}"}]}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.751491869531789*^9, 3.7514919587804065`*^9}, {
  3.7848170749747906`*^9, 3.784817075359997*^9}},
 CellLabel->"In[10]:=",ExpressionUUID->"41ab6c0b-0c83-4e3d-a591-6911e3987ebf"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{
   "Define", " ", "simplicial", " ", "homology", " ", "of", " ", "ordered", 
    " ", "simplicial", " ", 
    RowBox[{"complexes", ".", " ", "More"}], " ", "precisely"}], ",", " ", 
   RowBox[{"Betti", " ", "numbers", " ", "and", " ", "torsion", " ", 
    RowBox[{"coefficients", ".", " ", "An"}], " ", "ordered", " ", 
    "simplicial", " ", "complex", " ", "is", " ", "given", " ", "as", " ", 
    "a", " ", "list", " ", "S", " ", "containing", " ", "ordered", " ", 
    "sets", " ", "of", " ", "vertices"}], ",", " ", 
   RowBox[{
   "where", " ", "S", " ", "is", " ", "not", " ", "assumed", " ", "to", " ", 
    "be", " ", "downward", " ", "closed", " ", "with", " ", "respect", " ", 
    "to", " ", "sublist", " ", 
    RowBox[{"containment", ".", " ", "This"}], " ", "is", " ", "for", " ", 
    "convenience", " ", "of", " ", 
    RowBox[{"input", ".", " ", "To"}], " ", "close", " ", "such", " ", "a", 
    " ", "set", " ", "S", " ", "downwards"}], ",", " ", 
   RowBox[{
   "or", " ", "list", " ", "simplices", " ", "of", " ", "S", " ", "in", " ", 
    "a", " ", "particular", " ", "dimension"}], ",", " ", 
   RowBox[{"use", " ", 
    RowBox[{"\"\<simplices\>\"", ".", " ", "Next"}]}], ",", " ", 
   RowBox[{
   "simpboundary", " ", "is", " ", "the", " ", "relevant", " ", "simplicial", 
    " ", "boundary", " ", "matrix"}], ",", " ", 
   RowBox[{
   "which", " ", "is", " ", "then", " ", "used", " ", "in", " ", 
    "\"\<simpbetti\>\"", " ", "and", " ", "\"\<simptorsion\>\"", " ", "to", 
    " ", "compute", " ", "Betti", " ", "numbers", " ", "and", " ", "torsion", 
    " ", "coefficients", " ", "in", " ", "various", " ", 
    RowBox[{"degrees", ".", " ", "The"}], " ", "functions", " ", "whose", " ",
     "name", " ", "begins", " ", "with", " ", "\"\<n\>\"", " ", "compute", 
    " ", "the", " ", "matrix", " ", "ranks", " ", "using", " ", "a", " ", 
    "numerical", " ", 
    RowBox[{"algorithm", "."}]}]}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.784817006328163*^9, 3.7848170535037627`*^9}, {
  3.784818740187862*^9, 3.784818758531*^9}, {3.784818931033601*^9, 
  3.7848192786954794`*^9}, {3.7848346867936215`*^9, 3.784834689728101*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"47ba5779-4bf6-4b68-a440-765bfac1efde"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"sublists", "[", 
   RowBox[{"s_", ",", "P_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"sublists", "[", 
    RowBox[{"s", ",", "P"}], "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"s", "[", 
      RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", 
    RowBox[{"Subsets", "[", 
     RowBox[{
      RowBox[{"Range", "[", 
       RowBox[{"Length", "[", "s", "]"}], "]"}], ",", "P"}], 
     "]"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sublists", "[", "s_", "]"}], ":=", 
  RowBox[{
   RowBox[{"sublists", "[", "s", "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"s", "[", 
      RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", 
    RowBox[{"Subsets", "[", 
     RowBox[{"Range", "[", 
      RowBox[{"Length", "[", "s", "]"}], "]"}], "]"}]}]}]}]}], "Input",
 CellChangeTimes->{{3.754397157939617*^9, 3.754397184580223*^9}, {
  3.756556549901023*^9, 3.756556550154336*^9}, {3.7565565872821226`*^9, 
  3.7565565981054363`*^9}},
 CellLabel->"In[12]:=",ExpressionUUID->"f371d8ae-4249-4e69-bb49-d2d54f9f1258"],

Cell[BoxData[
 RowBox[{
  RowBox[{"simpdim", "[", "S_", "]"}], ":=", 
  RowBox[{
   RowBox[{"simpdim", "[", "S", "]"}], "=", 
   RowBox[{
    RowBox[{"Max", "[", 
     RowBox[{"Length", "/@", "S"}], "]"}], "-", "1"}]}]}]], "Input",
 CellChangeTimes->{{3.7542098896428423`*^9, 3.7542099015572605`*^9}, {
  3.7542100605823*^9, 3.7542100633486156`*^9}},
 CellLabel->
  "In[148]:=",ExpressionUUID->"eed7d771-8524-4a7d-97ff-053fb34ca93f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"simplices", "[", 
   RowBox[{"S_", ",", "n_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"simplices", "[", 
    RowBox[{"S", ",", "n"}], "]"}], "=", 
   RowBox[{"Union", "@@", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"sublists", "[", 
       RowBox[{"s", ",", 
        RowBox[{"{", 
         RowBox[{"n", "+", "1"}], "}"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"s", ",", "S"}], "}"}]}], "]"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"simplices", "[", "S_", "]"}], ":=", 
  RowBox[{
   RowBox[{"simplices", "[", "S", "]"}], "=", 
   RowBox[{"Union", "@@", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"simplices", "[", 
       RowBox[{"S", ",", "n"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"n", ",", "0", ",", 
        RowBox[{"simpdim", "[", "S", "]"}]}], "}"}]}], "]"}]}]}]}]}], "Input",
 CellChangeTimes->{{3.7086977705323315`*^9, 3.708697810700629*^9}, {
  3.708697902924904*^9, 3.7086979070011373`*^9}, {3.7086982746471653`*^9, 
  3.7086982746931677`*^9}, {3.7086994044297853`*^9, 3.7086994085360203`*^9}, {
  3.708701244791048*^9, 3.708701248566264*^9}, {3.7360143361099825`*^9, 
  3.7360143478956566`*^9}, {3.736014402342771*^9, 3.736014424092015*^9}, {
  3.736014888595649*^9, 3.736014892338863*^9}, {3.73615158555246*^9, 
  3.7361515953626986`*^9}, {3.753787817601716*^9, 3.7537878204613934`*^9}, {
  3.754406337015262*^9, 3.754406339818302*^9}, {3.754406997929009*^9, 
  3.75440699901445*^9}, {3.7565566354221134`*^9, 3.7565566358069468`*^9}},
 CellLabel->
  "In[149]:=",ExpressionUUID->"9d511a95-6838-42f0-911f-c8ef483348b6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"simpcrank", "[", 
   RowBox[{"S_", ",", "n_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"simpcrank", "[", 
    RowBox[{"S", ",", "n"}], "]"}], "=", 
   RowBox[{"Length", "[", 
    RowBox[{"simplices", "[", 
     RowBox[{"S", ",", "n"}], "]"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.7565570720807953`*^9, 3.7565570779642334`*^9}},
 CellLabel->
  "In[151]:=",ExpressionUUID->"bceaf04c-78b8-42c1-ae2f-41b5d71a6bba"],

Cell[BoxData[
 RowBox[{
  RowBox[{"simpboundary", "[", 
   RowBox[{"S_", ",", "n_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"simpboundary", "[", 
    RowBox[{"S", ",", "n"}], "]"}], "=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"n", "\[Equal]", "0"}], "||", 
      RowBox[{"n", ">", 
       RowBox[{"simpdim", "[", "S", "]"}]}]}], ",", 
     RowBox[{"{", "}"}], ",", 
     RowBox[{"Normal", "[", 
      RowBox[{"SparseArray", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "\[Rule]", 
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "&"}], "/@", 
         RowBox[{"(", 
          RowBox[{"Union", "@@", 
           RowBox[{"(", 
            RowBox[{"Transpose", "/@", 
             RowBox[{"Transpose", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Transpose", "/@", 
                 RowBox[{"Transpose", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"Flatten", "/@", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"Drop", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", "i", "}"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "1", ",", 
                    RowBox[{"n", "+", "1"}]}], "}"}]}], "]"}], "&"}], "/@", 
                    RowBox[{"simplices", "[", 
                    RowBox[{"S", ",", "n"}], "]"}]}], "/.", 
                    RowBox[{"PositionIndex", "[", 
                    RowBox[{"simplices", "[", 
                    RowBox[{"S", ",", 
                    RowBox[{"n", "-", "1"}]}], "]"}], "]"}]}], ")"}]}], ")"}],
                     ",", 
                    RowBox[{"KroneckerProduct", "[", 
                    RowBox[{
                    RowBox[{"Range", "[", 
                    RowBox[{"simpcrank", "[", 
                    RowBox[{"S", ",", "n"}], "]"}], "]"}], ",", 
                    RowBox[{"ConstantArray", "[", 
                    RowBox[{"1", ",", 
                    RowBox[{"{", 
                    RowBox[{"n", "+", "1"}], "}"}]}], "]"}]}], "]"}]}], "}"}],
                   "]"}]}], ",", 
                RowBox[{"ConstantArray", "[", 
                 RowBox[{
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"-", "1"}], ")"}], "^", "i"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "1", ",", 
                    RowBox[{"n", "+", "1"}]}], "}"}]}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"simpcrank", "[", 
                    RowBox[{"S", ",", "n"}], "]"}], "}"}]}], "]"}]}], "}"}], 
              "]"}]}], ")"}]}], ")"}]}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"simpcrank", "[", 
           RowBox[{"S", ",", 
            RowBox[{"n", "-", "1"}]}], "]"}], ",", 
          RowBox[{"simpcrank", "[", 
           RowBox[{"S", ",", "n"}], "]"}]}], "}"}]}], "]"}], "]"}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.7537924103468866`*^9, 3.753792455757924*^9}, {
  3.753792535476905*^9, 3.75379259562975*^9}, {3.7537927542722363`*^9, 
  3.7537927957972765`*^9}, {3.753793547398313*^9, 3.753793574978614*^9}, {
  3.7537936352212577`*^9, 3.753793697462927*^9}, {3.753793810305153*^9, 
  3.753793826806855*^9}, {3.75379420464845*^9, 3.753794234964182*^9}, {
  3.7537953861256514`*^9, 3.7537955251640625`*^9}, {3.7537956084955482`*^9, 
  3.7537956294977264`*^9}, {3.7537956727684937`*^9, 3.7537957221336884`*^9}, {
  3.754475719367978*^9, 3.754475800222329*^9}, {3.756556696941851*^9, 
  3.7565567000428295`*^9}, {3.756556802951538*^9, 3.756556804113869*^9}, {
  3.7565571022356534`*^9, 3.756557120318608*^9}, {3.784817190278884*^9, 
  3.7848171939440517`*^9}, {3.784819892468999*^9, 3.7848198960879197`*^9}},
 CellLabel->
  "In[152]:=",ExpressionUUID->"1ba52779-230a-40cb-bf04-3f05ea2eb784"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"simprank", "[", 
   RowBox[{"S_", ",", "n_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"simprank", "[", 
    RowBox[{"S", ",", "n"}], "]"}], "=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"n", "\[Equal]", "0"}], "||", 
      RowBox[{
       RowBox[{"simplices", "[", 
        RowBox[{"S", ",", "n"}], "]"}], "\[Equal]", 
       RowBox[{"{", "}"}]}]}], ",", "0", ",", 
     RowBox[{"MatrixRank", "[", 
      RowBox[{"simpboundary", "[", 
       RowBox[{"S", ",", "n"}], "]"}], "]"}]}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"simprank", "[", 
   RowBox[{"S_", ",", "n_", ",", "p_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"simprank", "[", 
    RowBox[{"S", ",", "n", ",", "p"}], "]"}], "=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"n", "\[Equal]", "0"}], "||", 
      RowBox[{
       RowBox[{"simplices", "[", 
        RowBox[{"S", ",", "n"}], "]"}], "\[Equal]", 
       RowBox[{"{", "}"}]}]}], ",", "0", ",", 
     RowBox[{"MatrixRank", "[", 
      RowBox[{
       RowBox[{"simpboundary", "[", 
        RowBox[{"S", ",", "n"}], "]"}], ",", 
       RowBox[{"Modulus", "\[Rule]", "p"}]}], "]"}]}], "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.7515221896244507`*^9, 3.751522194782812*^9}, {
  3.7537878476371512`*^9, 3.753787863213022*^9}, {3.7544758881322217`*^9, 
  3.7544759017001085`*^9}, {3.756556781389573*^9, 3.7565568142757196`*^9}, {
  3.756557035478731*^9, 3.756557040043825*^9}, {3.756557137376872*^9, 
  3.7565571535895596`*^9}, {3.756558774915702*^9, 3.7565587906599307`*^9}},
 CellLabel->
  "In[153]:=",ExpressionUUID->"bc75a8ae-ed76-412f-9c90-b122fec401c5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"simpbetti", "[", 
   RowBox[{"S_", ",", "n_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"simpbetti", "[", 
    RowBox[{"S", ",", "n"}], "]"}], "=", 
   RowBox[{
    RowBox[{"simpcrank", "[", 
     RowBox[{"S", ",", "n"}], "]"}], "-", 
    RowBox[{"simprank", "[", 
     RowBox[{"S", ",", "n"}], "]"}], "-", 
    RowBox[{"simprank", "[", 
     RowBox[{"S", ",", 
      RowBox[{"n", "+", "1"}]}], "]"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"simpbetti", "[", 
   RowBox[{"S_", ",", "n_", ",", "p_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"simpbetti", "[", 
    RowBox[{"S", ",", "n", ",", "p"}], "]"}], "=", 
   RowBox[{
    RowBox[{"simpcrank", "[", 
     RowBox[{"S", ",", "n"}], "]"}], "-", 
    RowBox[{"simprank", "[", 
     RowBox[{"S", ",", "n", ",", "p"}], "]"}], "-", 
    RowBox[{"simprank", "[", 
     RowBox[{"S", ",", 
      RowBox[{"n", "+", "1"}], ",", "p"}], "]"}]}]}]}]}], "Input",
 CellChangeTimes->{{3.708699579685809*^9, 3.7086995925725465`*^9}, {
  3.708699741561068*^9, 3.708699770073699*^9}, {3.708699940019419*^9, 
  3.7086999484739027`*^9}, {3.708700017681861*^9, 3.7087000200459967`*^9}, {
  3.7360054958237677`*^9, 3.736005510409794*^9}, {3.73601502796562*^9, 
  3.7360150920102835`*^9}, {3.7515219667839575`*^9, 3.7515219704249797`*^9}, {
  3.753787867139542*^9, 3.7537878759842205`*^9}, {3.754475904733552*^9, 
  3.7544759201311865`*^9}, {3.7565568226124396`*^9, 3.756556852066044*^9}, {
  3.756556882072188*^9, 3.756556887644754*^9}, {3.7565570480066495`*^9, 
  3.756557054367593*^9}, {3.7565587967743626`*^9, 3.756558825803094*^9}},
 CellLabel->
  "In[155]:=",ExpressionUUID->"f503ad48-e739-4004-9174-1fe925eb4796"],

Cell[BoxData[
 RowBox[{
  RowBox[{"simptorsion", "[", 
   RowBox[{"S_", ",", "n_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"simptorsion", "[", 
    RowBox[{"S", ",", "n"}], "]"}], "=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"0", "<", "n", "<", 
      RowBox[{"simpdim", "[", "S", "]"}]}], ",", 
     RowBox[{"Select", "[", 
      RowBox[{
       RowBox[{"Diagonal", "[", 
        RowBox[{
         RowBox[{"SmithDecomposition", "[", 
          RowBox[{"simpboundary", "[", 
           RowBox[{"S", ",", 
            RowBox[{"n", "+", "1"}]}], "]"}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"#", ">", "1"}], "&"}]}], "]"}], ",", 
     RowBox[{"{", "}"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.754208643928368*^9, 3.7542086531010437`*^9}, {
   3.754208946408475*^9, 3.7542089674989367`*^9}, {3.7542089993934855`*^9, 
   3.754209045702162*^9}, {3.754209078242995*^9, 3.7542091084718113`*^9}, {
   3.754209324075686*^9, 3.754209339228257*^9}, {3.754209375603123*^9, 
   3.7542093846799135`*^9}, {3.7542094532460003`*^9, 3.754209453415701*^9}, 
   3.754209529526456*^9, {3.754210074544213*^9, 3.7542100805863466`*^9}, {
   3.7544759231159105`*^9, 3.7544759314883895`*^9}, {3.756556893349178*^9, 
   3.756556902045453*^9}, {3.756557172176654*^9, 3.756557181530848*^9}},
 CellLabel->
  "In[157]:=",ExpressionUUID->"4bdf224b-3445-4e84-8b41-6907a68ffe48"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"simphomology", "[", "S_", "]"}], ":=", 
  RowBox[{
   RowBox[{"simphomology", "[", "S", "]"}], "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"simpbetti", "[", 
      RowBox[{"S", ",", "j"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "0", ",", 
       RowBox[{"simpdim", "[", "S", "]"}]}], "}"}]}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"simphomology", "[", 
   RowBox[{"S_", ",", "p_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"simphomology", "[", 
    RowBox[{"S", ",", "p"}], "]"}], "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"simpbetti", "[", 
      RowBox[{"S", ",", "j", ",", "p"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "0", ",", 
       RowBox[{"simpdim", "[", "S", "]"}]}], "}"}]}], "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.7565587434528995`*^9, 3.756558747372207*^9}, {
  3.7565596533685484`*^9, 3.7565596640296884`*^9}, {3.784817236728922*^9, 
  3.784817246820365*^9}, {3.784818401963039*^9, 3.784818411235245*^9}},
 CellLabel->
  "In[158]:=",ExpressionUUID->"b7791bef-b8b1-43a7-9e26-50ec43cb3677"],

Cell[BoxData[
 RowBox[{
  RowBox[{"nsimprank", "[", 
   RowBox[{"S_", ",", "n_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"nsimprank", "[", 
    RowBox[{"S", ",", "n"}], "]"}], "=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"n", "\[Equal]", "0"}], "||", 
      RowBox[{
       RowBox[{"simplices", "[", 
        RowBox[{"S", ",", "n"}], "]"}], "\[Equal]", 
       RowBox[{"{", "}"}]}]}], ",", "0", ",", 
     RowBox[{"Length", "[", 
      RowBox[{"SingularValueList", "[", 
       RowBox[{"N", "[", 
        RowBox[{"simpboundary", "[", 
         RowBox[{"S", ",", "n"}], "]"}], "]"}], "]"}], "]"}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.756556939866056*^9, 3.756556960447392*^9}, {
  3.756557206000186*^9, 3.7565572416196804`*^9}, {3.756558839702592*^9, 
  3.7565588439067826`*^9}},
 CellLabel->
  "In[160]:=",ExpressionUUID->"261ead85-a6fd-45c0-b591-fe85a2a32363"],

Cell[BoxData[
 RowBox[{
  RowBox[{"nsimpbetti", "[", 
   RowBox[{"S_", ",", "n_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"nsimpbetti", "[", 
    RowBox[{"S", ",", "n"}], "]"}], "=", 
   RowBox[{
    RowBox[{"simpcrank", "[", 
     RowBox[{"S", ",", "n"}], "]"}], "-", 
    RowBox[{"nsimprank", "[", 
     RowBox[{"S", ",", "n"}], "]"}], "-", 
    RowBox[{"nsimprank", "[", 
     RowBox[{"S", ",", 
      RowBox[{"n", "+", "1"}]}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.7565569545955687`*^9, 3.75655695694556*^9}, {
  3.7565572496105657`*^9, 3.756557259975773*^9}, {3.756558851085614*^9, 
  3.7565588631312404`*^9}},
 CellLabel->
  "In[161]:=",ExpressionUUID->"ff1a517b-d757-4391-b471-06318ce8b4b1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"nsimphomology", "[", "S_", "]"}], ":=", 
  RowBox[{
   RowBox[{"nsimphomology", "[", "S", "]"}], "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"nsimpbetti", "[", 
      RowBox[{"S", ",", "j"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "0", ",", 
       RowBox[{"simpdim", "[", "S", "]"}]}], "}"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.7565586501522827`*^9, 3.756558677775174*^9}, {
  3.7848172513927526`*^9, 3.7848172537726336`*^9}, {3.7848184161886744`*^9, 
  3.7848184218464656`*^9}},
 CellLabel->
  "In[162]:=",ExpressionUUID->"d86ab14f-affc-4737-85dd-539a1fbf0cfc"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"Define", " ", "simplicial", " ", 
    RowBox[{"collapses", ".", " ", "Begin"}], " ", "by", " ", "defining", " ",
     "several", " ", "functions", " ", "to", " ", "find", " ", "maximal", " ",
     "faces", " ", "and", " ", "free", " ", "faces", " ", "in", " ", "an", 
    " ", "ordered", " ", "simplicial", " ", 
    RowBox[{"complex", ".", " ", "Then"}], " ", "define", " ", "the", " ", 
    "function", " ", "\"\<collapse\>\""}], ",", " ", 
   RowBox[{
   "which", " ", "uses", " ", "these", " ", "functions", " ", "to", " ", 
    "find", " ", "a", " ", "free", " ", "face", " ", "and", " ", "collapses", 
    " ", 
    RowBox[{"it", ".", " ", "The"}], " ", "function", " ", 
    "\"\<seqcollapse\>\"", " ", "iterates", " ", "\"\<collapse\>\"", " ", 
    "for", " ", "as", " ", "long", " ", "as", " ", 
    RowBox[{"possible", ".", " ", "The"}], " ", "function", " ", 
    "\"\<collapse\>\"", " ", "also", " ", "defines", " ", "the", " ", "value",
     " ", "of", " ", "\"\<maximalfaces\>\"", " ", "of", " ", "the", " ", 
    "obtained", " ", "complex", " ", "after", " ", "every", " ", "collapse"}],
    ",", " ", 
   RowBox[{"to", " ", "speed", " ", "up", " ", "the", " ", 
    RowBox[{"computations", "."}]}]}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.7848177930537367`*^9, 3.7848178008386602`*^9}, {
  3.784819349477948*^9, 3.7848193733791437`*^9}, {3.784819456862789*^9, 
  3.7848195177056437`*^9}, {3.7848197321164026`*^9, 3.7848198206428795`*^9}, {
  3.80009672635999*^9, 
  3.800096749099118*^9}},ExpressionUUID->"e209aaf4-6651-4f34-8d68-\
69f70fa1fa51"],

Cell[BoxData[
 RowBox[{
  RowBox[{"sublistQ", "[", 
   RowBox[{"j_", ",", "i_"}], "]"}], ":=", 
  RowBox[{"i", "==", 
   RowBox[{"(", 
    RowBox[{"j", "/.", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"#", "\[Rule]", "Nothing"}], ")"}], "&"}], "/@", 
       RowBox[{"Complement", "[", 
        RowBox[{"j", ",", "i"}], "]"}]}], ")"}]}], ")"}]}]}]], "Input",
 CellLabel->
  "In[164]:=",ExpressionUUID->"16fd4255-5596-49d5-a533-f1daf4a125e3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"maximalfaces", "[", "S_", "]"}], ":=", 
  RowBox[{
   RowBox[{"maximalfaces", "[", "S", "]"}], "=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"SD", "=", 
        RowBox[{"GroupBy", "[", 
         RowBox[{"S", ",", "Length"}], "]"}]}], ",", "n", ",", 
       RowBox[{"M", "=", 
        RowBox[{"{", "}"}]}], ",", "i"}], "}"}], ",", 
     RowBox[{
      RowBox[{"n", "=", 
       RowBox[{"Max", "[", 
        RowBox[{"Keys", "[", "SD", "]"}], "]"}]}], ";", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "0"}], ",", 
        RowBox[{"i", "\[LessEqual]", 
         RowBox[{"n", "-", "1"}]}], ",", 
        RowBox[{"i", "++"}], ",", 
        RowBox[{
         RowBox[{"M", "=", 
          RowBox[{"Join", "[", 
           RowBox[{"M", ",", 
            RowBox[{"SD", "[", 
             RowBox[{"n", "-", "i"}], "]"}]}], "]"}]}], ";", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"MissingQ", "[", 
            RowBox[{"SD", "[", 
             RowBox[{"n", "-", "i", "-", "1"}], "]"}], "]"}], ",", 
           RowBox[{
            RowBox[{"SD", "[", 
             RowBox[{"n", "-", "i", "-", "1"}], "]"}], "=", 
            RowBox[{"{", "}"}]}]}], "]"}], ";", 
         RowBox[{
          RowBox[{"SD", "[", 
           RowBox[{"n", "-", "i", "-", "1"}], "]"}], "=", 
          RowBox[{"Complement", "[", 
           RowBox[{
            RowBox[{"SD", "[", 
             RowBox[{"n", "-", "i", "-", "1"}], "]"}], ",", 
            RowBox[{"Join", "@@", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"sublists", "[", 
                 RowBox[{"#", ",", 
                  RowBox[{"{", 
                   RowBox[{"n", "-", "i", "-", "1"}], "}"}]}], "]"}], "&"}], "/@",
                "M"}], ")"}]}]}], "]"}]}], ";", 
         RowBox[{"SD", "=", 
          RowBox[{"KeyDrop", "[", 
           RowBox[{"SD", ",", 
            RowBox[{"n", "-", "i"}]}], "]"}]}]}]}], "]"}], ";", 
      RowBox[{"Return", "[", 
       RowBox[{"Sort", "[", "M", "]"}], "]"}]}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.7986125694161167`*^9, 3.7986125717661705`*^9}, {
  3.798745567451524*^9, 3.798745569273875*^9}},
 CellLabel->
  "In[165]:=",ExpressionUUID->"c1743ea1-ba54-482d-ba95-e1dd2150f75b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"maximalfaceabove", "[", 
   RowBox[{"t_", ",", "S_"}], "]"}], ":=", 
  RowBox[{"FirstCase", "[", 
   RowBox[{
    RowBox[{"maximalfaces", "[", "S", "]"}], ",", 
    RowBox[{"Riffle", "[", 
     RowBox[{"t", ",", "___", ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", 
        RowBox[{"-", "1"}], ",", "2"}], "}"}]}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7988917403170214`*^9, 3.798891785581773*^9}},
 CellLabel->
  "In[166]:=",ExpressionUUID->"25f45974-06bb-4ff8-9754-a76a92f05a48"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"abovetally", "[", "S_", "]"}], ":=", 
   RowBox[{
    RowBox[{"abovetally", "[", "S", "]"}], "=", 
    RowBox[{"Counts", "[", 
     RowBox[{"Join", "@@", 
      RowBox[{"(", 
       RowBox[{"sublists", "/@", 
        RowBox[{"maximalfaces", "[", "S", "]"}]}], ")"}]}], "]"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.754470832017268*^9, 3.75447085308348*^9}, {
   3.7544708927105227`*^9, 3.7544710083488655`*^9}, {3.754471115595315*^9, 
   3.7544711180813932`*^9}, {3.7544711808411236`*^9, 3.754471295242493*^9}, 
   3.7544719991423006`*^9, {3.7988782097407207`*^9, 3.798878261132304*^9}, {
   3.79887882558806*^9, 3.7988788622317653`*^9}, {3.7988795289226985`*^9, 
   3.798879547322509*^9}, {3.7988825846183844`*^9, 3.7988825862617264`*^9}, {
   3.7988957659819603`*^9, 3.7988957673432107`*^9}, 3.79889609575732*^9, 
   3.7988961361226234`*^9, {3.7988963123077374`*^9, 3.7988963227485065`*^9}, {
   3.7989029097477026`*^9, 3.7989029278644114`*^9}},
 CellLabel->
  "In[167]:=",ExpressionUUID->"ee5a6016-a107-462f-b76e-33209794f101"],

Cell[BoxData[
 RowBox[{
  RowBox[{"nmaxfacesabove", "[", 
   RowBox[{"t_", ",", "S_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"abovetally", "[", "S", "]"}], "[", "t", "]"}]}]], "Input",
 CellChangeTimes->{{3.754471168450716*^9, 3.754471173537027*^9}, {
   3.754471272258404*^9, 3.754471290007876*^9}, {3.754471371659315*^9, 
   3.754471373762966*^9}, {3.754471990032443*^9, 3.754471993936265*^9}, 
   3.7988855185016537`*^9},
 CellLabel->
  "In[168]:=",ExpressionUUID->"e1dd0764-08ed-4991-b81f-55d9c38ca97b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"freefaces", "[", "S_", "]"}], ":=", 
  RowBox[{
   RowBox[{"freefaces", "[", "S", "]"}], "=", 
   RowBox[{"Complement", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PositionIndex", "[", 
       RowBox[{"abovetally", "[", "S", "]"}], "]"}], "[", "1", "]"}], ",", 
     RowBox[{"Append", "[", 
      RowBox[{
       RowBox[{"maximalfaces", "[", "S", "]"}], ",", 
       RowBox[{"{", "}"}]}], "]"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.754472036027013*^9, 3.754472041861876*^9}, {
   3.754472079524726*^9, 3.75447208937024*^9}, {3.7544721559048133`*^9, 
   3.754472223477491*^9}, {3.7554113596578617`*^9, 3.755411368742098*^9}, 
   3.798885545732029*^9},
 CellLabel->
  "In[169]:=",ExpressionUUID->"d14ea0fe-4d0f-4018-a418-85c78941d453"],

Cell[BoxData[
 RowBox[{
  RowBox[{"findfreeface", "[", "S_", "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"freefaces", "[", "S", "]"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "}"}], "\[Rule]", 
       RowBox[{"{", "Null", "}"}]}], "}"}]}], ")"}], "[", 
   RowBox[{"[", "1", "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.754442353316183*^9, 3.7544423697594647`*^9}, {
  3.7544424239443674`*^9, 3.754442496221*^9}, {3.754472234055051*^9, 
  3.754472241937252*^9}, {3.7544737775226903`*^9, 3.7544737996387625`*^9}},
 CellLabel->
  "In[170]:=",ExpressionUUID->"0e2c3400-e7d3-44b3-a5a9-04ed9e23fa5b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"collapse", "[", 
   RowBox[{"t_", ",", "S_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"M", "=", 
       RowBox[{"maximalfaces", "[", "S", "]"}]}], ",", 
      RowBox[{"s", "=", 
       RowBox[{"maximalfaceabove", "[", 
        RowBox[{"t", ",", "S"}], "]"}]}], ",", "a", ",", "A", ",", "B", ",", 
      "C"}], "}"}], ",", 
    RowBox[{
     RowBox[{"A", "=", 
      RowBox[{"Select", "[", 
       RowBox[{
        RowBox[{"sublists", "[", 
         RowBox[{"s", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Length", "[", "s", "]"}], "-", "1"}], "}"}]}], "]"}], 
        ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"sublistQ", "[", 
             RowBox[{"#", ",", "t"}], "]"}]}], "&&", 
           RowBox[{
            RowBox[{"nmaxfacesabove", "[", 
             RowBox[{"#", ",", "S"}], "]"}], "\[Equal]", "1"}]}], ")"}], 
         "&"}]}], "]"}]}], ";", 
     RowBox[{"B", "=", 
      RowBox[{"Complement", "[", 
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{"M", ",", "A"}], "]"}], ",", 
        RowBox[{"{", "s", "}"}]}], "]"}]}], ";", 
     RowBox[{
      RowBox[{"maximalfaces", "[", "B", "]"}], "=", "B"}], ";", 
     RowBox[{"C", "=", 
      RowBox[{"abovetally", "[", "S", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"AssociateTo", "[", 
      RowBox[{"C", ",", 
       RowBox[{"Merge", "[", 
        RowBox[{
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"KeyTake", "[", 
              RowBox[{
               RowBox[{"abovetally", "[", "S", "]"}], ",", 
               RowBox[{"sublists", "[", "s", "]"}]}], "]"}], ",", 
             RowBox[{"AssociationMap", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"-", "1"}], ")"}], "&"}], ",", 
               RowBox[{"sublists", "[", "s", "]"}]}], "]"}]}], "}"}], ",", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"AssociationMap", "[", 
              RowBox[{
               RowBox[{"1", "&"}], ",", 
               RowBox[{"sublists", "[", "a", "]"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"a", ",", "A"}], "}"}]}], "]"}]}], "]"}], ",", 
         "Total"}], "]"}]}], "]"}], ";", 
     RowBox[{"KeyDropFrom", "[", 
      RowBox[{"C", ",", 
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"sublists", "[", "s", "]"}], ",", 
         RowBox[{
          RowBox[{"sublistQ", "[", 
           RowBox[{"#", ",", "t"}], "]"}], "&"}]}], "]"}]}], "]"}], ";", 
     RowBox[{
      RowBox[{"abovetally", "[", "B", "]"}], "=", "C"}], ";", 
     RowBox[{"Return", "[", "B", "]"}]}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"collapse", "[", 
   RowBox[{"Null", ",", "S_"}], "]"}], ":=", "S"}]}], "Input",
 CellChangeTimes->{{3.753787686293007*^9, 3.7537876867774687`*^9}, {
   3.7543968389526834`*^9, 3.7543968484417596`*^9}, {3.7544379844440885`*^9, 
   3.754437993832576*^9}, {3.754438027337969*^9, 3.7544380316108456`*^9}, {
   3.7544381892705956`*^9, 3.7544382295077677`*^9}, {3.7544389151258106`*^9, 
   3.754439018230474*^9}, {3.754439069125394*^9, 3.754439104490377*^9}, {
   3.7544427782554083`*^9, 3.7544428015884523`*^9}, {3.754443015366485*^9, 
   3.754443069899887*^9}, {3.75447171103738*^9, 3.754471713300564*^9}, {
   3.7544717646553373`*^9, 3.754471776603628*^9}, {3.7919170808649807`*^9, 
   3.791917081296692*^9}, 3.791917160446311*^9, {3.79861252780479*^9, 
   3.798612598666643*^9}, {3.7988342719181786`*^9, 3.798834272123733*^9}, {
   3.7988400576312466`*^9, 3.7988400581860285`*^9}, {3.798902874825739*^9, 
   3.798902881156271*^9}, {3.798902992996992*^9, 3.798903002560373*^9}},
 CellLabel->
  "In[171]:=",ExpressionUUID->"ee1453cf-0b2f-4cbb-a5c9-3f1503ca93bc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"seqcollapse", "[", "S_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"M", "=", 
       RowBox[{"maximalfaces", "[", "S", "]"}]}], ",", "t"}], "}"}], ",", 
    RowBox[{
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "M", "]"}], ">", "1"}], "||", 
        RowBox[{
         RowBox[{"Length", "[", 
          RowBox[{"M", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}], ">", "1"}]}], ",", 
       RowBox[{
        RowBox[{"t", "=", 
         RowBox[{"findfreeface", "[", "M", "]"}]}], ";", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"t", "\[Equal]", "Null"}], ",", 
          RowBox[{"Return", "[", 
           RowBox[{"maximalfaces", "[", "M", "]"}], "]"}]}], "]"}], ";", 
        RowBox[{"M", "=", 
         RowBox[{"collapse", "[", 
          RowBox[{"t", ",", "M"}], "]"}]}]}]}], "]"}], ";", 
     RowBox[{"Return", "[", "M", "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.751537968833061*^9, 3.7515379726667213`*^9}, {
  3.7515380078474765`*^9, 3.7515380516219015`*^9}, {3.7848195305327635`*^9, 
  3.7848195320001698`*^9}},
 CellLabel->
  "In[173]:=",ExpressionUUID->"91f52457-2e5e-4000-a508-4dae819db5c2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"seqcollapsibleQ", "[", "S_", "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Length", "[", "#", "]"}], ",", 
         RowBox[{"Length", "[", 
          RowBox[{"First", "[", "#", "]"}], "]"}]}], "}"}], "&"}], "@", 
      RowBox[{"seqcollapse", "[", "S", "]"}]}], "\[Equal]", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}]}], ",", "True", ",", "False"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.7837053308967695`*^9, 3.783705435728487*^9}, {
  3.7837055458855553`*^9, 3.7837055502531924`*^9}, {3.7837110013836546`*^9, 
  3.783711008385154*^9}, {3.7837110672433596`*^9, 3.7837110678215466`*^9}, {
  3.784819537104014*^9, 3.7848195381319075`*^9}, {3.7987490634856453`*^9, 
  3.7987490647590337`*^9}},
 CellLabel->
  "In[174]:=",ExpressionUUID->"109ba858-4d98-46a3-9334-801b5fd17439"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"Some", " ", "other", " ", "useful", " ", 
     RowBox[{"functions", ":", " ", 
      RowBox[{
      "\"\<uniqueindices\>\"", " ", "selects", " ", "unique", " ", "elements",
        " ", "from", " ", "given", " ", "lists"}]}]}], ";", " ", 
    RowBox[{
    "\"\<pop\>\"", " ", "removes", " ", "a", " ", "collection", " ", "of", 
     " ", "maximal", " ", "simplices"}], ";", " ", 
    RowBox[{
    "\"\<cone\>\"", " ", "cones", " ", "off", " ", "a", " ", "collection", 
     " ", "of", " ", "subcomplexes"}]}], ",", 
   RowBox[{
    RowBox[{"assuming", " ", "that", " ", "n"}], " ", "\[GreaterEqual]", " ", 
    RowBox[{
     RowBox[{"Max", "[", "M", "]"}], "."}]}]}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.784818514885275*^9, 3.7848185228755617`*^9}, {
  3.7848200041376004`*^9, 3.7848200228056355`*^9}, {3.7848200645226583`*^9, 
  3.784820192520886*^9}, {3.7848202269367943`*^9, 3.784820228621698*^9}, {
  3.7848215299544797`*^9, 3.7848215719112825`*^9}, {3.7848219668567824`*^9, 
  3.7848220138936763`*^9}, {3.7848220713960047`*^9, 3.7848220977207737`*^9}, {
  3.7848222296341095`*^9, 3.7848223488501425`*^9}, {3.784822400042632*^9, 
  3.7848224009644995`*^9}, {3.7848396430977244`*^9, 3.7848396514704747`*^9}, {
  3.7919172729632215`*^9, 3.791917278861404*^9}, {3.7919173123477736`*^9, 
  3.791917314961933*^9}, {3.791918270802597*^9, 3.791918283632036*^9}, {
  3.7988345663390923`*^9, 3.7988345717801847`*^9}, {3.7988346563128448`*^9, 
  3.7988346572904186`*^9}, {3.7988348131612806`*^9, 3.798834820646549*^9}},
 CellLabel->
  "In[175]:=",ExpressionUUID->"6d08066a-c400-401d-8af0-b6b83ff311f4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"uniqueindices", "[", "S_", "]"}], ":=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Complement", "[", 
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{"[", "i", "]"}], "]"}], ",", 
      RowBox[{"Union", "@@", 
       RowBox[{"Drop", "[", 
        RowBox[{"S", ",", 
         RowBox[{"{", "i", "}"}]}], "]"}]}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", 
      RowBox[{"Length", "[", "S", "]"}]}], "}"}]}], "]"}]}]], "Input",
 CellLabel->
  "In[176]:=",ExpressionUUID->"c7f5d9df-3ebb-4cbe-872a-b6880756924a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"pop", "[", 
   RowBox[{"S_", ",", "T_"}], "]"}], ":=", 
  RowBox[{"maximalfaces", "[", 
   RowBox[{"Union", "[", 
    RowBox[{
     RowBox[{"Complement", "[", 
      RowBox[{"S", ",", "T"}], "]"}], ",", 
     RowBox[{"Union", "@@", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"t", "/.", 
           RowBox[{"i", "\[Rule]", "Nothing"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "t"}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "T"}], "}"}]}], "]"}]}]}], "]"}], "]"}]}]], "Input",
 CellLabel->
  "In[177]:=",ExpressionUUID->"c66fb1e4-1900-4f75-be85-473ba38816fb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"cone", "[", 
   RowBox[{"M_", ",", "G_", ",", "n_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"MM", "=", 
       RowBox[{"maximalfaces", "[", "M", "]"}]}], ",", "B", ",", 
      RowBox[{"GG", "=", 
       RowBox[{"maximalfaces", "/@", "G"}]}], ",", "i"}], "}"}], ",", 
    RowBox[{
     RowBox[{"B", "=", 
      RowBox[{"Complement", "[", 
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{"MM", ",", 
          RowBox[{"Join", "@@", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Append", "[", 
                RowBox[{"#", ",", 
                 RowBox[{"n", "+", "i"}]}], "]"}], "&"}], "/@", 
              RowBox[{"GG", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{"Length", "[", "GG", "]"}]}], "}"}]}], "]"}]}]}], 
         "]"}], ",", 
        RowBox[{"Join", "@@", "GG"}]}], "]"}]}], ";", 
     RowBox[{
      RowBox[{"maximalfaces", "[", "B", "]"}], "=", "B"}], ";", 
     RowBox[{"Return", "[", "B", "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{
  3.7848181920002747`*^9, {3.7848200282109237`*^9, 3.7848200550363994`*^9}, {
   3.784820168428911*^9, 3.7848201714000034`*^9}, 3.7848215818211265`*^9, {
   3.7986127219270725`*^9, 3.798612727732072*^9}, {3.7988341706375513`*^9, 
   3.7988341869049177`*^9}, {3.7988342196368628`*^9, 
   3.7988342431411953`*^9}, {3.798834311282672*^9, 3.7988344231311374`*^9}, {
   3.798834483870715*^9, 3.79883449068069*^9}, 3.798834542211308*^9, {
   3.798834790316948*^9, 3.7988348959128914`*^9}, {3.798834983747841*^9, 
   3.7988349912158155`*^9}},
 CellLabel->
  "In[178]:=",ExpressionUUID->"41780967-d686-4c54-83f4-495aeeb18b70"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"An", " ", "alternative", " ", "to", " ", 
   RowBox[{"Mathematica", "'"}], "s", " ", "NullSpace", " ", 
   RowBox[{"algorithm", ":"}]}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.798129664766375*^9, 3.798129689619062*^9}},
 CellLabel->
  "In[179]:=",ExpressionUUID->"8abd2be6-86d8-4242-8a0b-554e8cd97904"],

Cell[BoxData[
 RowBox[{
  RowBox[{"nullspace", "[", "A_", "]"}], ":=", 
  RowBox[{"Reverse", "/@", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"Drop", "[", 
       RowBox[{"#", ",", 
        RowBox[{"Length", "[", "A", "]"}]}], "]"}], "&"}], "/@", 
     RowBox[{"Select", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"HermiteDecomposition", "[", 
         RowBox[{"Transpose", "[", 
          RowBox[{"ArrayFlatten", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"Reverse", "/@", "A"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"IdentityMatrix", "[", 
               RowBox[{"Length", "[", 
                RowBox[{"A", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "}"}]}], "}"}],
            "]"}], "]"}], "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", 
           RowBox[{"Range", "[", 
            RowBox[{"Length", "[", "A", "]"}], "]"}], "]"}], "]"}], 
         "\[Equal]", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{"0", ",", 
           RowBox[{"Length", "[", "A", "]"}]}], "]"}]}], "&"}]}], "]"}]}], 
    ")"}]}]}]], "Input",
 CellChangeTimes->{{3.798114781637966*^9, 3.798114928352296*^9}, {
  3.798115018445479*^9, 3.7981151245573435`*^9}, {3.7982977878185935`*^9, 
  3.7982978055272083`*^9}, {3.7983534529043145`*^9, 3.798353455820408*^9}},
 CellLabel->
  "In[180]:=",ExpressionUUID->"7c4a6870-83dd-4682-910b-2ac76f7d5f16"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
  "The", " ", "procedure", " ", "that", " ", "attempts", " ", "to", " ", 
   "pop", " ", "a", " ", "few", " ", "maximal", " ", "cells", " ", "and", " ",
    "show", " ", "that", " ", "the", " ", "rest", " ", "is", " ", 
   RowBox[{"contractible", "."}]}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.79193137226291*^9, 3.7919313818997235`*^9}, {
  3.7983188635754175`*^9, 3.7983189120474668`*^9}, {3.798319166930107*^9, 
  3.798319185245081*^9}},
 CellLabel->
  "In[181]:=",ExpressionUUID->"e9602b85-5c1d-40ca-b427-ea40b3a38e06"],

Cell[BoxData[
 RowBox[{
  RowBox[{"selectcells", "[", 
   RowBox[{"M_", ",", "d_", ",", "k_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"cells", "=", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"i", "=", "0"}], ",", "j", ",", "c"}], "}"}], ",", 
    RowBox[{
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"j", "=", "1"}], ",", 
       RowBox[{"j", "\[LessEqual]", 
        RowBox[{"Length", "[", "M", "]"}]}], ",", 
       RowBox[{"j", "++"}], ",", 
       RowBox[{
        RowBox[{"c", "=", 
         RowBox[{"M", "[", 
          RowBox[{"[", "j", "]"}], "]"}]}], ";", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"simpbetti", "[", 
               RowBox[{
                RowBox[{"pop", "[", 
                 RowBox[{"M", ",", "cells"}], "]"}], ",", "q"}], "]"}], "-", 
              RowBox[{"simpbetti", "[", 
               RowBox[{
                RowBox[{"pop", "[", 
                 RowBox[{"M", ",", 
                  RowBox[{"Append", "[", 
                   RowBox[{"cells", ",", "c"}], "]"}]}], "]"}], ",", "q"}], 
               "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"q", ",", "0", ",", 
               RowBox[{"simpdim", "[", "M", "]"}]}], "}"}]}], "]"}], 
           "\[Equal]", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"KroneckerDelta", "[", 
              RowBox[{"q", ",", "d"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"q", ",", "0", ",", 
               RowBox[{"simpdim", "[", "M", "]"}]}], "}"}]}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"cells", "=", 
            RowBox[{"Append", "[", 
             RowBox[{"cells", ",", "c"}], "]"}]}], ";", 
           RowBox[{"i", "=", 
            RowBox[{"i", "+", "1"}]}], ";", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"i", "\[Equal]", "k"}], ",", 
             RowBox[{"Return", "[", "cells", "]"}]}], "]"}]}]}], "]"}]}]}], 
      "]"}], ";", 
     RowBox[{"Return", "[", "Undefined", "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.754063558157605*^9, 3.7540635651489916`*^9}, 
   3.7565586060293465`*^9, {3.7565586851672173`*^9, 3.7565586895569477`*^9}, {
   3.7565587243860693`*^9, 3.7565587291060266`*^9}, {3.791926519523113*^9, 
   3.791926609137136*^9}, {3.791926699826036*^9, 3.791926728427972*^9}, {
   3.7919268516687975`*^9, 3.7919268771317153`*^9}, {3.7919269475376835`*^9, 
   3.7919269622770834`*^9}, {3.7919270702546043`*^9, 
   3.7919270704425077`*^9}, {3.791927492814752*^9, 3.7919274928299556`*^9}, {
   3.7919278614482393`*^9, 3.7919278694030075`*^9}, {3.791928396627617*^9, 
   3.7919284029615297`*^9}, {3.791928457582825*^9, 3.7919284811020656`*^9}, {
   3.791928729041263*^9, 3.7919287397867775`*^9}, {3.7919288070546446`*^9, 
   3.79192884561731*^9}, {3.7919290828551464`*^9, 3.791929121842555*^9}, {
   3.7919293498103013`*^9, 3.7919293499563026`*^9}, {3.791929805801857*^9, 
   3.7919298104493475`*^9}, {3.7919302894612837`*^9, 
   3.7919302963259706`*^9}, {3.7919304795449305`*^9, 
   3.7919304797163982`*^9}, {3.797536581182048*^9, 3.7975365998473244`*^9}},
 CellLabel->
  "In[182]:=",ExpressionUUID->"aaf0277e-30a4-432d-a716-325ad3466edd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"popeverything", "[", "S_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"M", ",", 
      RowBox[{"cells", "=", 
       RowBox[{"{", "}"}]}], ",", "dcells", ",", "H", ",", "Hindices", ",", 
      "d", ",", "k", ",", "i", ",", "acyclic"}], "}"}], ",", 
    RowBox[{
     RowBox[{"H", "=", 
      RowBox[{"Drop", "[", 
       RowBox[{
        RowBox[{"simphomology", "[", "S", "]"}], ",", "1"}], "]"}]}], ";", 
     RowBox[{"Hindices", "=", 
      RowBox[{"Union", "@@", 
       RowBox[{"KeyDrop", "[", 
        RowBox[{
         RowBox[{"PositionIndex", "[", "H", "]"}], ",", "0"}], "]"}]}]}], ";", 
     RowBox[{"M", "=", 
      RowBox[{"seqcollapse", "[", "S", "]"}]}], ";", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", 
        RowBox[{"Length", "[", "Hindices", "]"}]}], ",", 
       RowBox[{"i", "++"}], ",", 
       RowBox[{
        RowBox[{"d", "=", 
         RowBox[{"Hindices", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], ";", 
        RowBox[{"k", "=", 
         RowBox[{"H", "[", 
          RowBox[{"[", "d", "]"}], "]"}]}], ";", 
        RowBox[{"dcells", "=", 
         RowBox[{"selectcells", "[", 
          RowBox[{"M", ",", "d", ",", "k"}], "]"}]}], ";", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"dcells", "===", "Undefined"}], ",", 
          RowBox[{"Return", "[", "False", "]"}]}], "]"}], ";", 
        RowBox[{"cells", "=", 
         RowBox[{"Join", "[", 
          RowBox[{"cells", ",", "dcells"}], "]"}]}]}]}], "]"}], ";", 
     RowBox[{"acyclic", "=", 
      RowBox[{"seqcollapse", "[", 
       RowBox[{"pop", "[", 
        RowBox[{"M", ",", "cells"}], "]"}], "]"}]}], ";", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "acyclic", "]"}], "\[Equal]", 
        RowBox[{"Length", "[", 
         RowBox[{"acyclic", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}], "\[Equal]", "1"}], ",", 
       RowBox[{"Return", "[", "True", "]"}], ",", 
       RowBox[{"Return", "[", "False", "]"}]}], "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7515381830811777`*^9, 3.751538247026163*^9}, {
   3.751538278278783*^9, 3.751538284759431*^9}, {3.7515384132241583`*^9, 
   3.7515387130737114`*^9}, {3.7515388597658157`*^9, 3.751538862199512*^9}, 
   3.751538911209749*^9, {3.751539073937332*^9, 3.7515390951007915`*^9}, {
   3.751653533582029*^9, 3.7516535358361444`*^9}, {3.754061023459444*^9, 
   3.7540610335068007`*^9}, {3.754061461962621*^9, 3.754061478868561*^9}, {
   3.7540615529300547`*^9, 3.75406155861022*^9}, {3.7540615925106*^9, 
   3.7540616014323816`*^9}, {3.7540616636360593`*^9, 
   3.7540617818206944`*^9}, {3.754061847633853*^9, 3.7540618530234203`*^9}, {
   3.754061907333246*^9, 3.754061967280693*^9}, {3.7540620403637505`*^9, 
   3.7540620442542896`*^9}, {3.7540624781595106`*^9, 3.754062504977671*^9}, {
   3.7540635545085354`*^9, 3.7540635565413413`*^9}, {3.791725722578642*^9, 
   3.791725762123553*^9}, {3.79180432917931*^9, 3.791804341047654*^9}, {
   3.791924389701361*^9, 3.791924431983346*^9}, {3.7919244891735196`*^9, 
   3.7919244996090155`*^9}, {3.791924606687925*^9, 3.7919246105855827`*^9}, {
   3.7919246619886484`*^9, 3.7919246798446336`*^9}, {3.791924732729438*^9, 
   3.791924759576626*^9}, {3.7919248731590705`*^9, 3.791924920487522*^9}, {
   3.791927900641238*^9, 3.7919279286606693`*^9}, {3.7919283014742055`*^9, 
   3.7919283291948195`*^9}, {3.7919288550879498`*^9, 3.791928874423192*^9}, {
   3.791929131743024*^9, 3.7919291667872744`*^9}, {3.79192926306143*^9, 
   3.791929275709321*^9}, {3.7919298030488873`*^9, 3.791929803239127*^9}, {
   3.7919303586510825`*^9, 3.79193035868258*^9}, {3.791930389190298*^9, 
   3.791930389220997*^9}, {3.791930434049261*^9, 3.7919304599352727`*^9}, {
   3.791930567866254*^9, 3.7919305705457335`*^9}, {3.7987487717217455`*^9, 
   3.7987487784832077`*^9}},
 CellLabel->
  "In[183]:=",ExpressionUUID->"fbb496ae-a39f-4b78-acdb-3c5a9f4db875"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"The", " ", "coning", " ", "and", " ", "collapsing", " ", 
   RowBox[{"procedure", "."}]}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.78481852816197*^9, 3.7848185390518813`*^9}},
 CellLabel->
  "In[184]:=",ExpressionUUID->"4d118668-f37a-432d-bb97-e9e65fb8ebfd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"findgoodcycles", "[", 
   RowBox[{"M_", ",", "d_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"goodcycles", "=", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"topsimplices", "=", 
       RowBox[{"simplices", "[", 
        RowBox[{"M", ",", "d"}], "]"}]}], ",", 
      RowBox[{"cycles", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Last", "/@", "#"}], "&"}], "/@", 
        RowBox[{"GatherBy", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"SparseArray", "[", 
            RowBox[{"nullspace", "[", 
             RowBox[{"simpboundary", "[", 
              RowBox[{"M", ",", "d"}], "]"}], "]"}], "]"}], "[", 
           "\"\<NonzeroPositions\>\"", "]"}], ",", "First"}], "]"}]}]}], ",", 
      "indexlist"}], "}"}], ",", 
    RowBox[{
     RowBox[{"indexlist", "=", 
      RowBox[{"uniqueindices", "[", "cycles", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"simpbetti", "[", 
                RowBox[{
                 RowBox[{"topsimplices", "[", 
                  RowBox[{"[", 
                   RowBox[{"cycles", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], ",", "k"}], 
                "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"k", ",", "0", ",", "d"}], "}"}]}], "]"}], "!=", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"KroneckerDelta", "[", 
                 RowBox[{"k", ",", "0"}], "]"}], "+", 
                RowBox[{"KroneckerDelta", "[", 
                 RowBox[{"k", ",", "d"}], "]"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"k", ",", "0", ",", "d"}], "}"}]}], "]"}]}], ",", 
            RowBox[{"Break", "[", "]"}]}], "]"}], ";", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"seqcollapsibleQ", "[", 
             RowBox[{"pop", "[", 
              RowBox[{
               RowBox[{"topsimplices", "[", 
                RowBox[{"[", 
                 RowBox[{"cycles", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], ",", 
               RowBox[{"topsimplices", "[", 
                RowBox[{"[", 
                 RowBox[{"{", "j", "}"}], "]"}], "]"}]}], "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{"AppendTo", "[", 
              RowBox[{"goodcycles", ",", 
               RowBox[{"cycles", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ";", 
             RowBox[{"Break", "[", "]"}]}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", 
           RowBox[{"indexlist", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "cycles", "]"}]}], "}"}]}], "]"}], ";", 
     RowBox[{"Return", "[", "goodcycles", "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7848175198456063`*^9, 3.784817532453541*^9}, {
   3.784820468021285*^9, 3.7848204704758263`*^9}, {3.784820502965954*^9, 
   3.7848205209772005`*^9}, {3.7848205530106354`*^9, 3.784820658484454*^9}, {
   3.7848207104428167`*^9, 3.78482072236959*^9}, 3.7848207536406527`*^9, {
   3.7848208768746862`*^9, 3.784820927455167*^9}, {3.7848210117600527`*^9, 
   3.7848210249829273`*^9}, {3.78483417759974*^9, 3.784834233545191*^9}, {
   3.7848342728691235`*^9, 3.78483439057115*^9}, {3.7981299962090387`*^9, 
   3.7981299983975277`*^9}, {3.7981448504788647`*^9, 3.798144851162959*^9}, {
   3.798297814537651*^9, 3.798297815849329*^9}, {3.7987490867569437`*^9, 
   3.7987490876374044`*^9}},
 CellLabel->
  "In[185]:=",ExpressionUUID->"1b75755c-88a1-40a1-b6df-bc7aba0987ae"],

Cell[BoxData[
 RowBox[{
  RowBox[{"findgoodcomponents", "[", 
   RowBox[{"M_", ",", "d_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"goodcomponents", "=", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"topsimplices", "=", 
       RowBox[{"simplices", "[", 
        RowBox[{"M", ",", "d"}], "]"}]}], ",", "indices", ",", 
      "componentvertices", ",", "components"}], "}"}], ",", 
    RowBox[{
     RowBox[{"componentvertices", "=", 
      RowBox[{"Sort", "[", 
       RowBox[{"Sort", "/@", 
        RowBox[{"(", 
         RowBox[{"ConnectedComponents", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "\[UndirectedEdge]", 
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "&"}], "/@", 
           RowBox[{"simplices", "[", 
            RowBox[{"topsimplices", ",", "1"}], "]"}]}], "]"}], ")"}]}], 
       "]"}]}], ";", 
     RowBox[{"components", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Select", "[", 
         RowBox[{"topsimplices", ",", 
          RowBox[{
           RowBox[{"SubsetQ", "[", 
            RowBox[{
             RowBox[{"componentvertices", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", "#"}], "]"}], "&"}]}], 
         "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "componentvertices", "]"}]}], "}"}]}], 
       "]"}]}], ";", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"indices", "=", 
         RowBox[{"{", "}"}]}], ";", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"simpbetti", "[", 
              RowBox[{
               RowBox[{"components", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", "k"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"k", ",", "0", ",", 
               RowBox[{"d", "-", "1"}]}], "}"}]}], "]"}], "\[Equal]", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"KroneckerDelta", "[", 
              RowBox[{"k", ",", "0"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"k", ",", "0", ",", 
               RowBox[{"d", "-", "1"}]}], "}"}]}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"Do", "[", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"simpbetti", "[", 
                 RowBox[{
                  RowBox[{"pop", "[", 
                   RowBox[{
                    RowBox[{"components", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"components", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"Append", "[", 
                    RowBox[{"indices", ",", "j"}], "]"}], "]"}], "]"}]}], 
                   "]"}], ",", "d"}], "]"}], "\[Equal]", 
                RowBox[{
                 RowBox[{"simpbetti", "[", 
                  RowBox[{
                   RowBox[{"pop", "[", 
                    RowBox[{
                    RowBox[{"components", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"components", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "indices", "]"}], "]"}]}], "]"}], ",", "d"}],
                   "]"}], "-", "1"}]}], ",", 
               RowBox[{"AppendTo", "[", 
                RowBox[{"indices", ",", "j"}], "]"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", "1", ",", 
               RowBox[{"Length", "[", 
                RowBox[{"components", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], ";", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"seqcollapsibleQ", "[", 
              RowBox[{"pop", "[", 
               RowBox[{
                RowBox[{"components", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], ",", 
                RowBox[{
                 RowBox[{"components", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "[", 
                 RowBox[{"[", "indices", "]"}], "]"}]}], "]"}], "]"}], ",", 
             RowBox[{"AppendTo", "[", 
              RowBox[{"goodcomponents", ",", 
               RowBox[{"components", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], "]"}]}]}], "]"}]}],
        ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "components", "]"}]}], "}"}]}], "]"}], ";", 
     RowBox[{"Return", "[", "goodcomponents", "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.784820750054488*^9, 3.7848207589456806`*^9}, {
   3.784820851034681*^9, 3.784820862647071*^9}, {3.7848209360327215`*^9, 
   3.7848209980600533`*^9}, {3.7848210300919466`*^9, 
   3.7848210323346224`*^9}, {3.784821128202218*^9, 3.7848211444287806`*^9}, {
   3.7848340370594635`*^9, 3.7848340613076425`*^9}, {3.7848344596388464`*^9, 
   3.7848344655906615`*^9}, 3.798613457738681*^9, 3.7986136285668554`*^9, {
   3.79874909733515*^9, 3.79874909779151*^9}, {3.7988338146555457`*^9, 
   3.7988338192920227`*^9}, {3.7989160220546675`*^9, 3.7989160340077343`*^9}},
 CellLabel->
  "In[186]:=",ExpressionUUID->"0f6bd8ad-7317-4ae0-affc-2b40f9b9446b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"coneandcollapse", "[", "S_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"M", "=", 
       RowBox[{"seqcollapse", "[", "S", "]"}]}], ",", "d", ",", "n", ",", 
      "goodcycles", ",", "goodcomponents", ",", "i", ",", "j", ",", "k"}], 
     "}"}], ",", 
    RowBox[{"While", "[", 
     RowBox[{"True", ",", 
      RowBox[{
       RowBox[{"d", "=", 
        RowBox[{"simpdim", "[", "M", "]"}]}], ";", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"d", "\[Equal]", "0"}], "&&", 
          RowBox[{
           RowBox[{"Length", "[", "M", "]"}], "\[Equal]", "1"}], "&&", 
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{"First", "[", "M", "]"}], "]"}], "\[Equal]", "1"}]}], ",", 
         RowBox[{
          RowBox[{
          "Print", "[", "\"\<The complex is a wedge of spheres.\>\"", "]"}], 
          ";", 
          RowBox[{"Return", "[", "]"}]}]}], "]"}], ";", 
       RowBox[{"n", "=", 
        RowBox[{"Max", "[", "M", "]"}]}], ";", 
       RowBox[{"goodcycles", "=", 
        RowBox[{"findgoodcycles", "[", 
         RowBox[{"M", ",", "d"}], "]"}]}], ";", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Found \>\"", "<>", 
         RowBox[{"ToString", "[", 
          RowBox[{"Length", "[", "goodcycles", "]"}], "]"}], "<>", 
         "\"\< cycle(s) in the top dimension (d = \>\"", "<>", 
         RowBox[{"ToString", "[", "d", "]"}], "<>", 
         "\"\<) that can be coned off.\>\""}], "]"}], ";", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"goodcycles", "===", 
          RowBox[{"{", "}"}]}], ",", 
         RowBox[{
          RowBox[{"goodcomponents", "=", 
           RowBox[{"findgoodcomponents", "[", 
            RowBox[{"M", ",", "d"}], "]"}]}], ";", 
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<The subcomplex spanned by the top-dimensional simplices has \
\>\"", "<>", 
            RowBox[{"ToString", "[", 
             RowBox[{"Length", "[", "goodcomponents", "]"}], "]"}], "<>", 
            "\"\< component(s) which can be coned off. Here are the numbers \
of spherical summands in each of these components: \>\"", "<>", 
            RowBox[{"ToString", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"simpbetti", "[", 
                RowBox[{"#", ",", "d"}], "]"}], "&"}], "/@", 
              "goodcomponents"}], "]"}], "<>", "\"\<.\>\""}], "]"}], ";", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"goodcomponents", "===", 
             RowBox[{"{", "}"}]}], ",", 
            RowBox[{
             RowBox[{
             "Print", "[", 
              "\"\<Unable to simplify the complex any further.\>\"", "]"}], 
             ";", 
             RowBox[{"Return", "[", "M", "]"}]}], ",", 
            RowBox[{"M", "=", 
             RowBox[{"seqcollapse", "[", 
              RowBox[{"cone", "[", 
               RowBox[{"M", ",", "goodcomponents", ",", "n"}], "]"}], 
              "]"}]}]}], "]"}]}], ",", 
         RowBox[{"M", "=", 
          RowBox[{"seqcollapse", "[", 
           RowBox[{"cone", "[", 
            RowBox[{"M", ",", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"simplices", "[", 
                 RowBox[{"M", ",", "d"}], "]"}], "[", 
                RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", "goodcycles"}], 
             ",", "n"}], "]"}], "]"}]}]}], "]"}], ";", 
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<The Betti numbers (computed numerically) after the coning \
operation are: \>\"", "<>", 
         RowBox[{"ToString", "[", 
          RowBox[{"nsimphomology", "[", "M", "]"}], "]"}], "<>", 
         "\"\<.\>\""}], "]"}]}]}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.784818548259283*^9, 3.78481854969067*^9}, {
   3.7848195437255087`*^9, 3.7848195557225018`*^9}, {3.784820035798728*^9, 
   3.784820061005311*^9}, {3.7848207830154805`*^9, 3.7848208093376465`*^9}, {
   3.7848211026749096`*^9, 3.784821111161463*^9}, {3.7848211714873767`*^9, 
   3.7848212368355255`*^9}, {3.7848216171841393`*^9, 3.784821646779724*^9}, {
   3.7848342129560003`*^9, 3.7848342147049913`*^9}, 3.784834321728314*^9, 
   3.784834373481806*^9, 3.7848344390888762`*^9, 3.784834475320905*^9, {
   3.784834511035225*^9, 3.784834549960961*^9}, {3.7848347123315864`*^9, 
   3.784834745499956*^9}, {3.7848347891527033`*^9, 3.784834794376669*^9}, {
   3.7848353089474726`*^9, 3.78483531010341*^9}, {3.784843135400305*^9, 
   3.7848431439493465`*^9}},
 CellLabel->
  "In[187]:=",ExpressionUUID->"660790d7-4677-463c-aeb6-f0352b252a9e"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{
   "Define", " ", "flag", " ", "tournaplexes", " ", "of", " ", "directed", 
    " ", "graphs"}], ",", " ", 
   RowBox[{
   "using", " ", "a", " ", "procedure", " ", "inspired", " ", "by", " ", 
    "the", " ", "Flagser", " ", 
    RowBox[{"algorithm", ".", " ", "A"}], " ", "directed", " ", "graph", " ", 
    "is", " ", "given", " ", "by", " ", "its", " ", "list", " ", "of", " ", 
    "edges", " ", 
    RowBox[{"e", ".", " ", "Edges"}], " ", "are", " ", "pairs", " ", "whose", 
    " ", "first", " ", "component", " ", "is", " ", "the", " ", "initial", 
    " ", "vertex", " ", "and", " ", "second", " ", "component", " ", "is", 
    " ", "the", " ", "terminal", " ", 
    RowBox[{"vertex", ".", " ", "The"}], " ", "simplices", " ", "of", " ", 
    "the", " ", "flag", " ", "complex", " ", "are", " ", "computed", " ", 
    "in", " ", "each", " ", "dimension", " ", "separately", " ", "and", " ", 
    "given", " ", "as", " ", "lists", " ", "of", " ", 
    RowBox[{"edges", ".", " ", "To"}], " ", "represent", " ", "each", " ", 
    "simplex", " ", "in", " ", "a", " ", "canonical", " ", "way"}], ",", " ", 
   RowBox[{
   "the", " ", "edges", " ", "within", " ", "these", " ", "lists", " ", "are",
     " ", "ordered", " ", 
    RowBox[{"lexicographically", "."}]}]}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.777835817745695*^9, 3.7778358263511877`*^9}, {
  3.7911965127856445`*^9, 3.7911965187479687`*^9}, {3.798363654821854*^9, 
  3.7983636661766467`*^9}, {3.7983637064239855`*^9, 3.7983637110372906`*^9}, {
  3.7983675048772106`*^9, 3.798367581255836*^9}, {3.7983676236168203`*^9, 
  3.798367698496441*^9}},
 CellLabel->
  "In[188]:=",ExpressionUUID->"f77694f3-e55c-4e40-a1b0-e800da356406"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
  "Collapses", " ", "for", " ", "tournaplexes", " ", "will", " ", "be", " ", 
   "added", " ", "in", " ", "a", " ", "later", " ", "version", " ", "of", " ",
    "the", " ", 
   RowBox[{"code", "."}]}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.7983666088184347`*^9, 3.7983666300309315`*^9}},
 CellLabel->
  "In[189]:=",ExpressionUUID->"8a34dca7-72bd-41e4-b198-ce4fcfeb26e8"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{
   "The", " ", "following", " ", "function", " ", "assumes", " ", "the", " ", 
    "vertices", " ", "of", " ", "the", " ", "graph", " ", "are", " ", 
    "labeled", " ", "numerically", " ", "and", " ", "are", " ", "contiguous", 
    " ", "from", " ", "0", " ", "to", " ", "the", " ", 
    RowBox[{"maximum", ".", " ", "If"}], " ", "a", " ", "certain", " ", 
    "vertex", " ", "in", " ", "this", " ", "range", " ", "does", " ", "not", 
    " ", "appear", " ", "in", " ", "any", " ", "of", " ", "the", " ", "edges",
     " ", "of", " ", "the", " ", "graph"}], ",", " ", 
   RowBox[{
   "it", " ", "is", " ", "treated", " ", "as", " ", "an", " ", "isolated", 
    " ", 
    RowBox[{"vertex", ".", " ", "This"}], " ", "is", " ", "ad", " ", "hoc", 
    " ", "for", " ", "the", " ", "purposes", " ", "of", " ", "the", " ", 
    "computation", " ", "at", " ", "hand", " ", "and", " ", "will", " ", "be",
     " ", "generalised", " ", "in", " ", "a", " ", "future", " ", 
    RowBox[{"version", "."}]}]}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.798363749120541*^9, 3.7983639047956142`*^9}},
 CellLabel->
  "In[190]:=",ExpressionUUID->"4ba3fee6-b818-41b4-a874-736b30e20436"],

Cell[BoxData[
 RowBox[{
  RowBox[{"vertices", "[", "e_", "]"}], ":=", 
  RowBox[{
   RowBox[{"vertices", "[", "e", "]"}], "=", 
   RowBox[{"Range", "[", 
    RowBox[{"0", ",", 
     RowBox[{"Max", "[", 
      RowBox[{"Flatten", "[", "e", "]"}], "]"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.7468736769311223`*^9, 3.7468737043819532`*^9}, {
  3.7468737463036394`*^9, 3.746873749490259*^9}},
 CellLabel->
  "In[191]:=",ExpressionUUID->"651b1f42-d205-498e-8572-d1a877875ffe"],

Cell[BoxData[
 RowBox[{
  RowBox[{"vlookup", "[", "e_", "]"}], ":=", 
  RowBox[{
   RowBox[{"vlookup", "[", "e", "]"}], "=", 
   RowBox[{"Union", "/@", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", "#", "]"}], ">", "1"}], ",", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", "Nothing"}], "]"}], ")"}], 
          "&"}], "/@", "#"}], ")"}], "&"}], "/@", 
      RowBox[{"GatherBy", "[", 
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"{", "#", "}"}], "&"}], "/@", 
           RowBox[{"vertices", "[", "e", "]"}]}], ",", 
          RowBox[{"Sort", "[", 
           RowBox[{"Sort", "/@", "e"}], "]"}]}], "]"}], ",", "First"}], 
       "]"}]}], ")"}]}]}]}]], "Input",
 CellChangeTimes->{{3.747995229722534*^9, 3.7479952328447475`*^9}},
 CellLabel->
  "In[192]:=",ExpressionUUID->"d8b2cefb-8949-46a2-88e5-2fe511dae1d6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"lower", "[", "e_", "]"}], ":=", 
  RowBox[{"Select", "[", 
   RowBox[{"e", ",", 
    RowBox[{
     RowBox[{
      RowBox[{"#", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "<", 
      RowBox[{"#", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], "&"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.742557582009544*^9, 3.7425576217433004`*^9}},
 CellLabel->
  "In[193]:=",ExpressionUUID->"48d337e3-a806-4b4c-841c-f11711ced927"],

Cell[BoxData[
 RowBox[{
  RowBox[{"upper", "[", "e_", "]"}], ":=", 
  RowBox[{"Select", "[", 
   RowBox[{"e", ",", 
    RowBox[{
     RowBox[{
      RowBox[{"#", "[", 
       RowBox[{"[", "1", "]"}], "]"}], ">", 
      RowBox[{"#", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], "&"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.742557642770816*^9, 3.742557648644887*^9}},
 CellLabel->
  "In[194]:=",ExpressionUUID->"9c6d3991-d41f-46bb-88e6-8676d780e947"],

Cell[BoxData[
 RowBox[{
  RowBox[{"lowerelookup", "[", "e_", "]"}], ":=", 
  RowBox[{
   RowBox[{"lowerelookup", "[", "e", "]"}], "=", 
   RowBox[{"Union", "/@", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", "#", "]"}], ">", "1"}], ",", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", "Nothing"}], "]"}], ")"}], 
          "&"}], "/@", "#"}], ")"}], "&"}], "/@", 
      RowBox[{"GatherBy", "[", 
       RowBox[{
        RowBox[{"SortBy", "[", 
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"{", "#", "}"}], "&"}], "/@", 
             RowBox[{"vertices", "[", "e", "]"}]}], ",", 
            RowBox[{"lower", "[", "e", "]"}]}], "]"}], ",", "Min"}], "]"}], 
        ",", "Min"}], "]"}]}], ")"}]}]}]}]], "Input",
 CellChangeTimes->{{3.7425575638135014`*^9, 3.742557575260174*^9}, {
  3.7425576599546604`*^9, 3.742557670732471*^9}, {3.7425578001210637`*^9, 
  3.742557805089375*^9}, {3.742557895873557*^9, 3.742557897581207*^9}, {
  3.746871981281508*^9, 3.746872036010891*^9}, {3.746873729104776*^9, 
  3.746873731975152*^9}},
 CellLabel->
  "In[195]:=",ExpressionUUID->"015a7150-ec45-4938-89cf-7fd49769a5f8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"upperelookup", "[", "e_", "]"}], ":=", 
  RowBox[{
   RowBox[{"upperelookup", "[", "e", "]"}], "=", 
   RowBox[{"Union", "/@", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", "#", "]"}], ">", "1"}], ",", 
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", "Nothing"}], "]"}], ")"}], 
          "&"}], "/@", "#"}], ")"}], "&"}], "/@", 
      RowBox[{"GatherBy", "[", 
       RowBox[{
        RowBox[{"SortBy", "[", 
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"{", "#", "}"}], "&"}], "/@", 
             RowBox[{"vertices", "[", "e", "]"}]}], ",", 
            RowBox[{"upper", "[", "e", "]"}]}], "]"}], ",", "Min"}], "]"}], 
        ",", "Min"}], "]"}]}], ")"}]}]}]}]], "Input",
 CellChangeTimes->{{3.742557679204324*^9, 3.74255768938731*^9}, {
  3.742557823225501*^9, 3.7425578386660748`*^9}, {3.742557876516342*^9, 
  3.742557905697173*^9}, {3.7468719879547424`*^9, 3.746872011159094*^9}, {
  3.7468720448520746`*^9, 3.7468720552626095`*^9}, {3.746873739429386*^9, 
  3.7468737416996293`*^9}},
 CellLabel->
  "In[196]:=",ExpressionUUID->"dd035d69-4e48-4ca8-ba4f-d062a26a3d05"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"flagtplx", "[", 
   RowBox[{"e_", ",", 
    RowBox[{"-", "1"}]}], "]"}], ":=", 
  RowBox[{
   RowBox[{"flagtplx", "[", 
    RowBox[{"e", ",", 
     RowBox[{"-", "1"}]}], "]"}], "=", 
   RowBox[{"{", "}"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"flagtplx", "[", 
   RowBox[{"e_", ",", "0"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"flagtplx", "[", 
    RowBox[{"e", ",", "0"}], "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"{", "#", "}"}], "&"}], "/@", 
    RowBox[{"vertices", "[", "e", "]"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"flagtplx", "[", 
   RowBox[{"e_", ",", "1"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"flagtplx", "[", 
    RowBox[{"e", ",", "1"}], "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"{", "#", "}"}], "&"}], "/@", "e"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"flagtplx", "[", 
   RowBox[{"e_", ",", "i_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"flagtplx", "[", 
    RowBox[{"e", ",", "i"}], "]"}], "=", 
   RowBox[{"Sort", "/@", 
    RowBox[{"(", 
     RowBox[{"Join", "@@", 
      RowBox[{"Join", "@@", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Join", "[", 
              RowBox[{"s", ",", "q"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"q", ",", 
               RowBox[{"Tuples", "[", 
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"Union", "[", 
                   RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"lowerelookup", "[", "e", "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Min", "[", 
                    RowBox[{"k", ",", "l"}], "]"}], "+", "1"}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"Max", "[", 
                    RowBox[{"k", ",", "l"}], "]"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Min", "[", 
                    RowBox[{"k", ",", "l"}], "]"}], ",", 
                    RowBox[{"Max", "[", 
                    RowBox[{"k", ",", "l"}], "]"}]}], "}"}], "}"}], ",", 
                    RowBox[{"{", "}"}]}], "]"}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"upperelookup", "[", "e", "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Min", "[", 
                    RowBox[{"k", ",", "l"}], "]"}], "+", "1"}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"Max", "[", 
                    RowBox[{"k", ",", "l"}], "]"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Max", "[", 
                    RowBox[{"k", ",", "l"}], "]"}], ",", 
                    RowBox[{"Min", "[", 
                    RowBox[{"k", ",", "l"}], "]"}]}], "}"}], "}"}], ",", 
                    RowBox[{"{", "}"}]}], "]"}]}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"l", ",", 
                    RowBox[{"Union", "@@", "s"}]}], "}"}]}], "]"}], "]"}]}], 
              "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", 
             RowBox[{"Intersection", "@@", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"vlookup", "[", "e", "]"}], "[", 
                 RowBox[{"[", 
                  RowBox[{"j", "+", "1"}], "]"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"j", ",", 
                  RowBox[{"Union", "@@", "s"}]}], "}"}]}], "]"}]}]}], "}"}]}],
           "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"s", ",", 
           RowBox[{"flagtplx", "[", 
            RowBox[{"e", ",", 
             RowBox[{"i", "-", "1"}]}], "]"}]}], "}"}]}], "]"}]}]}], 
     ")"}]}]}]}]}], "Input",
 CellChangeTimes->{{3.7425568003137226`*^9, 3.7425568320201707`*^9}, {
  3.7425580002451105`*^9, 3.7425580385079145`*^9}, {3.742558157748356*^9, 
  3.742558180235175*^9}, {3.7425582326112056`*^9, 3.74255823614382*^9}, {
  3.742558284207878*^9, 3.742558412158989*^9}, {3.742558451057482*^9, 
  3.7425584833968277`*^9}, {3.742558621521087*^9, 3.742558629456334*^9}, {
  3.7479952582490726`*^9, 3.7479952612200055`*^9}, {3.791196460004616*^9, 
  3.7911965000054283`*^9}},
 CellLabel->
  "In[197]:=",ExpressionUUID->"778ea909-204a-48db-ad37-839011d1f673"],

Cell[BoxData[
 RowBox[{
  RowBox[{"tdim", "[", "e_", "]"}], ":=", 
  RowBox[{
   RowBox[{"tdim", "[", "e", "]"}], "=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"i", "=", "0"}], "}"}], ",", 
     RowBox[{
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"flagtplx", "[", 
          RowBox[{"e", ",", "i"}], "]"}], "\[NotEqual]", 
         RowBox[{"{", "}"}]}], ",", 
        RowBox[{"i", "++"}]}], "]"}], ";", 
      RowBox[{"Return", "[", 
       RowBox[{"i", "-", "1"}], "]"}]}]}], "]"}]}]}]], "Input",
 CellLabel->
  "In[201]:=",ExpressionUUID->"b80b03ba-604f-425c-855a-70d743af20ea"],

Cell[BoxData[
 RowBox[{
  RowBox[{"fullflagtplx", "[", "e_", "]"}], ":=", 
  RowBox[{
   RowBox[{"fullflagtplx", "[", "e", "]"}], "=", 
   RowBox[{"Union", "@@", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"flagtplx", "[", 
       RowBox[{"e", ",", "i"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "0", ",", 
        RowBox[{"tdim", "[", "e", "]"}]}], "}"}]}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.7911966238964405`*^9, 3.7911966329281483`*^9}},
 CellLabel->
  "In[202]:=",ExpressionUUID->"4832ecb9-0bda-4e24-ac5c-6d2be66a740c"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Directionality", " ", 
   RowBox[{"functions", ".", " ", 
    RowBox[{"Note", ":", " ", 
     RowBox[{
     "locdir", " ", "computes", " ", "the", " ", "local", " ", 
      "directionality", " ", "weight", " ", "of", " ", "the", " ", "simplex", 
      " ", "rather", " ", "than", " ", "its", " ", "local", " ", 
      RowBox[{"directionality", "."}]}]}]}]}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.7911965018975296`*^9, 3.7911965080135436`*^9}, {
  3.798376837809144*^9, 3.798376871699154*^9}},
 CellLabel->
  "In[203]:=",ExpressionUUID->"7ebc58a4-90e1-4a3c-873c-a731ee24d9c3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"sdeg", "[", 
   RowBox[{"e_", ",", "v_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"sdeg", "[", 
    RowBox[{"e", ",", "v"}], "]"}], "=", 
   RowBox[{
    RowBox[{"Count", "[", 
     RowBox[{"e", ",", 
      RowBox[{"{", 
       RowBox[{"_", ",", "v"}], "}"}]}], "]"}], "-", 
    RowBox[{"Count", "[", 
     RowBox[{"e", ",", 
      RowBox[{"{", 
       RowBox[{"v", ",", "_"}], "}"}]}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.7404763278859043`*^9, 3.740476340496449*^9}, {
  3.7406472342322674`*^9, 3.740647270439931*^9}, {3.7406473724017105`*^9, 
  3.7406473879237375`*^9}, {3.750418105073908*^9, 3.75041810890914*^9}},
 CellLabel->
  "In[204]:=",ExpressionUUID->"e76b04fa-8a94-4886-9449-9f0053ce1ab7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"globdir", "[", 
   RowBox[{"e_", ",", "sigma_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"globdir", "[", 
    RowBox[{"e", ",", "sigma"}], "]"}], "=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Head", "[", 
       RowBox[{"sigma", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "]"}], "===", "List"}], ",", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"sdeg", "[", 
         RowBox[{"e", ",", "v"}], "]"}], "^", "2"}], ",", 
       RowBox[{"{", 
        RowBox[{"v", ",", 
         RowBox[{"Union", "@@", "sigma"}]}], "}"}]}], "]"}], ",", 
     RowBox[{
      RowBox[{"sdeg", "[", 
       RowBox[{"e", ",", 
        RowBox[{"sigma", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "^", "2"}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.7404017822910757`*^9, 3.7404017893491726`*^9}, {
  3.7406470231638966`*^9, 3.7406470281871057`*^9}, {3.7406474545046544`*^9, 
  3.7406474677802773`*^9}, {3.7406474996667337`*^9, 3.7406475052515435`*^9}, {
  3.740648469442437*^9, 3.740648470596839*^9}, {3.740648847160775*^9, 
  3.7406488843044405`*^9}, {3.7406489367829328`*^9, 3.740649013862668*^9}, {
  3.740649483392293*^9, 3.7406495135783463`*^9}, {3.7504181128810387`*^9, 
  3.7504181166470904`*^9}, {3.798364435394555*^9, 3.798364440033279*^9}},
 CellLabel->
  "In[205]:=",ExpressionUUID->"17429eec-aa0c-41fe-905e-2ad1c76c2a17"],

Cell[BoxData[
 RowBox[{
  RowBox[{"sdim", "[", "sigma_", "]"}], ":=", 
  RowBox[{
   RowBox[{"sdim", "[", "sigma", "]"}], "=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Head", "[", 
       RowBox[{"sigma", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "]"}], "===", "List"}], ",", 
     RowBox[{
      RowBox[{"Length", "[", 
       RowBox[{"Union", "@@", "sigma"}], "]"}], "-", "1"}], ",", "0"}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.750418144412277*^9, 3.7504181460762453`*^9}},
 CellLabel->
  "In[206]:=",ExpressionUUID->"508247c4-e75f-4c4a-9d70-be69b67993cf"],

Cell[BoxData[
 RowBox[{
  RowBox[{"locdir", "[", "sigma_", "]"}], ":=", 
  RowBox[{
   RowBox[{"locdir", "[", "sigma", "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"globdir", "[", 
       RowBox[{"sigma", ",", "sigma"}], "]"}], "+", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"#", "-", "1"}], ")"}], "#", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"#", "+", "1"}], ")"}], "/", "3"}]}], ")"}]}], "&"}], "[", 
    RowBox[{"sdim", "[", "sigma", "]"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.7406475212103715`*^9, 3.7406476326101675`*^9}, {
  3.740647695462678*^9, 3.740647695915078*^9}, {3.7406477352739477`*^9, 
  3.7406477434015617`*^9}, {3.7406478087032766`*^9, 3.7406478248025045`*^9}, {
  3.740647947964721*^9, 3.740647951193927*^9}, {3.7406494417090197`*^9, 
  3.740649444751025*^9}, {3.7406495911884823`*^9, 3.7406496249937415`*^9}, {
  3.7504181514174232`*^9, 3.7504181544817495`*^9}, {3.7983644472257776`*^9, 
  3.7983644551721573`*^9}},
 CellLabel->
  "In[207]:=",ExpressionUUID->"3b529ffb-14cc-4f73-80d5-f31366931a26"],

Cell[BoxData[
 RowBox[{
  RowBox[{"c3dir", "[", "sigma_", "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"2", 
      RowBox[{"Binomial", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"sdim", "[", "sigma", "]"}], "+", "2"}], ",", "3"}], "]"}]}],
      "+", 
     RowBox[{"2", 
      RowBox[{"Binomial", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"sdim", "[", "sigma", "]"}], "+", "1"}], ",", "3"}], "]"}]}],
      "-", 
     RowBox[{"locdir", "[", "sigma", "]"}]}], ")"}], "/", "8"}]}]], "Input",
 CellChangeTimes->{{3.791228268626476*^9, 3.7912282755869493`*^9}, 
   3.791228424133204*^9, {3.7983644630068893`*^9, 3.7983644638443766`*^9}},
 CellLabel->
  "In[208]:=",ExpressionUUID->"133a198e-996a-4b54-af41-5f5e4cc43b6f"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"Define", " ", "simplicial", " ", "homology", " ", "of", " ", 
    RowBox[{"tournaplexes", ".", " ", "More"}], " ", "precisely"}], ",", " ", 
   RowBox[{"Betti", " ", "numbers", " ", "and", " ", "torsion", " ", 
    RowBox[{"coefficients", ".", " ", "A"}], " ", "tournaplex", " ", "is", 
    " ", "given", " ", "as", " ", "a", " ", "list", " ", "S", " ", 
    "containing", " ", "lists", " ", "of", " ", "edges"}], ",", " ", 
   RowBox[{
   "where", " ", "S", " ", "is", " ", "not", " ", "assumed", " ", "to", " ", 
    "be", " ", "downward", " ", "closed", " ", "with", " ", "respect", " ", 
    "to", " ", "subtournament", " ", 
    RowBox[{"containment", ".", " ", "This"}], " ", "is", " ", "for", " ", 
    "convenience", " ", "of", " ", 
    RowBox[{"input", ".", " ", "To"}], " ", "close", " ", "such", " ", "a", 
    " ", "set", " ", "S", " ", "downwards"}], ",", " ", 
   RowBox[{
   "or", " ", "list", " ", "simplices", " ", "of", " ", "S", " ", "in", " ", 
    "a", " ", "particular", " ", "dimension"}], ",", " ", 
   RowBox[{"use", " ", 
    RowBox[{"\"\<tsimplices\>\"", ".", " ", "Next"}]}], ",", " ", 
   RowBox[{
   "tsimpboundary", " ", "is", " ", "the", " ", "relevant", " ", "simplicial",
     " ", "boundary", " ", "matrix"}], ",", " ", 
   RowBox[{
   "which", " ", "is", " ", "then", " ", "used", " ", "in", " ", 
    "\"\<tsimpbetti\>\"", " ", "and", " ", "\"\<tsimptorsion\>\"", " ", "to", 
    " ", "compute", " ", "Betti", " ", "numbers", " ", "and", " ", "torsion", 
    " ", "coefficients", " ", "in", " ", "various", " ", 
    RowBox[{"degrees", ".", " ", "The"}], " ", "functions", " ", "whose", " ",
     "name", " ", "begins", " ", "with", " ", "\"\<n\>\"", " ", "compute", 
    " ", "the", " ", "matrix", " ", "ranks", " ", "using", " ", "a", " ", 
    "numerical", " ", 
    RowBox[{"algorithm", "."}]}]}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.7515219039567766`*^9, 3.751521913310469*^9}, {
  3.754406343088497*^9, 3.754406344443491*^9}, {3.7772949022991734`*^9, 
  3.7772949588449664`*^9}, {3.77729502032734*^9, 3.77729516529994*^9}, {
  3.791200294327651*^9, 3.7912003415787954`*^9}, {3.7983642023426847`*^9, 
  3.7983642733091197`*^9}},
 CellLabel->
  "In[209]:=",ExpressionUUID->"ebf85001-9f3c-4a25-a3a1-21214f66f644"],

Cell[BoxData[
 RowBox[{
  RowBox[{"tsimpdim", "[", "S_", "]"}], ":=", 
  RowBox[{
   RowBox[{"tsimpdim", "[", "S", "]"}], "=", 
   RowBox[{
    RowBox[{"Max", "[", 
     RowBox[{"Length", "/@", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Union", "[", 
          RowBox[{"Flatten", "[", "#", "]"}], "]"}], "&"}], "/@", "S"}], 
       ")"}]}], "]"}], "-", "1"}]}]}]], "Input",
 CellChangeTimes->{{3.7542098896428423`*^9, 3.7542099015572605`*^9}, {
  3.7542100605823*^9, 3.7542100633486156`*^9}, {3.791221221298175*^9, 
  3.791221223117996*^9}, {3.7912212679138327`*^9, 3.7912212716066494`*^9}, {
  3.7912223883810587`*^9, 3.7912223902171917`*^9}, {3.7912281426520424`*^9, 
  3.7912281475464783`*^9}},
 CellLabel->
  "In[210]:=",ExpressionUUID->"e6c59a1d-e555-429a-bd55-3551fd756c11"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{
   "The", " ", "method", " ", "used", " ", "to", " ", "determine", " ", "the",
     " ", "simplices", " ", "of", " ", "the", " ", "complex", " ", "from", 
    " ", "a", " ", "list", " ", "of", " ", "faces", " ", "that", " ", "span", 
    " ", "it", " ", "is", " ", "a", " ", "bit", " ", "ad", " ", 
    RowBox[{"hoc", ".", " ", "It"}], " ", "works", " ", "well", " ", "enough",
     " ", "for", " ", "the", " ", "purpose", " ", "at", " ", "hand"}], ",", 
   " ", 
   RowBox[{
   "but", " ", "will", " ", "most", " ", "likely", " ", "be", " ", "replaced",
     " ", "by", " ", "a", " ", "more", " ", "systematic", " ", "method", " ", 
    "in", " ", "the", " ", 
    RowBox[{"future", "."}]}]}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.798364570837113*^9, 3.7983647390169773`*^9}, {
  3.8000967771434755`*^9, 
  3.8000967785743647`*^9}},ExpressionUUID->"a7f6a439-a4b5-41e0-bcf4-\
9a8be53e4851"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"subtournscodim1", "[", "s_", "]"}], ":=", 
  RowBox[{
   RowBox[{"subtournscodim1", "[", "s", "]"}], "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"DeleteCases", "[", 
        RowBox[{"s", ",", 
         RowBox[{"{", 
          RowBox[{"___", ",", "#", ",", "___"}], "}"}]}], "]"}], "&"}], "/@", 
      RowBox[{"Union", "[", 
       RowBox[{"Flatten", "[", "s", "]"}], "]"}]}], ")"}], "/.", 
    RowBox[{
     RowBox[{"{", "}"}], "\[Rule]", "Nothing"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tsimplices", "[", 
   RowBox[{"S_", ",", "0"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"tsimplices", "[", 
    RowBox[{"S", ",", "0"}], "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"{", "#", "}"}], "&"}], "/@", 
    RowBox[{"Union", "[", 
     RowBox[{"Flatten", "[", "S", "]"}], "]"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tsimplicespositive", "[", "S_", "]"}], ":=", 
  RowBox[{
   RowBox[{"tsimplicespositive", "[", "S", "]"}], "=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Splus", "=", 
       RowBox[{"{", 
        RowBox[{"Cases", "[", 
         RowBox[{"S", ",", 
          RowBox[{"{", 
           RowBox[{"___", ",", "_List", ",", "___"}], "}"}]}], "]"}], "}"}]}],
       "}"}], ",", 
     RowBox[{
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{"AppendTo", "[", 
         RowBox[{"Splus", ",", 
          RowBox[{"Union", "@@", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"subtournscodim1", "[", "s", "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"s", ",", 
               RowBox[{"Last", "[", "Splus", "]"}]}], "}"}]}], "]"}]}]}], 
         "]"}], ",", 
        RowBox[{"tsimpdim", "[", "S", "]"}]}], "]"}], ";", 
      RowBox[{"Return", "[", 
       RowBox[{"Union", "@@", "Splus"}], "]"}]}]}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tsimplices", "[", "S_", "]"}], ":=", 
  RowBox[{
   RowBox[{"tsimplices", "[", "S", "]"}], "=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"tsimplices", "[", 
      RowBox[{"S", ",", "0"}], "]"}], ",", 
     RowBox[{"tsimplicespositive", "[", "S", "]"}]}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tsimplices", "[", 
   RowBox[{"S_", ",", "n_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"tsimplices", "[", 
    RowBox[{"S", ",", "n"}], "]"}], "=", 
   RowBox[{"Select", "[", 
    RowBox[{
     RowBox[{"tsimplicespositive", "[", "S", "]"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"Length", "[", "#", "]"}], "\[Equal]", 
       RowBox[{"Binomial", "[", 
        RowBox[{
         RowBox[{"n", "+", "1"}], ",", "2"}], "]"}]}], "&"}]}], 
    "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.7975942178921165`*^9, 3.797594337108506*^9}, {
  3.797594400782164*^9, 3.7975944075222836`*^9}, {3.797595493330143*^9, 
  3.7975955213023024`*^9}, {3.7975955538113203`*^9, 3.79759562313354*^9}, {
  3.797596242176076*^9, 3.7975962486105967`*^9}, {3.797597194025322*^9, 
  3.7975971971430717`*^9}, {3.797597435152653*^9, 3.797597458004145*^9}, {
  3.797599288411866*^9, 3.7975992983847256`*^9}, {3.797599412648941*^9, 
  3.797599426795242*^9}},
 CellLabel->
  "In[212]:=",ExpressionUUID->"599194e6-d0a0-49f8-8bb0-7bc16060fce9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"tsimpcrank", "[", 
   RowBox[{"S_", ",", "n_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"tsimpcrank", "[", 
    RowBox[{"S", ",", "n"}], "]"}], "=", 
   RowBox[{"Length", "[", 
    RowBox[{"tsimplices", "[", 
     RowBox[{"S", ",", "n"}], "]"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.7565570720807953`*^9, 3.7565570779642334`*^9}, {
  3.7912212759623404`*^9, 3.791221281673643*^9}},
 CellLabel->
  "In[217]:=",ExpressionUUID->"6d0cf0d0-3b16-4944-8d5c-0b91453acf9c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"tsimpboundary", "[", 
   RowBox[{"S_", ",", "1"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"tsimpboundary", "[", 
    RowBox[{"S", ",", "1"}], "]"}], "=", 
   RowBox[{"SparseArray", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "\[Rule]", 
         RowBox[{"#", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "&"}], "/@", 
      RowBox[{"(", 
       RowBox[{"Union", "@@", 
        RowBox[{"(", 
         RowBox[{"Transpose", "/@", 
          RowBox[{"Transpose", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Transpose", "/@", 
              RowBox[{"Transpose", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"Flatten", "/@", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"Drop", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "//", "Sort"}], ",", 
                    RowBox[{"{", "i", "}"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "1", ",", "2"}], "}"}]}], "]"}], ")"}], 
                    "&"}], "/@", 
                    RowBox[{"tsimplices", "[", 
                    RowBox[{"S", ",", "1"}], "]"}]}], "/.", 
                    RowBox[{"PositionIndex", "[", 
                    RowBox[{"tsimplices", "[", 
                    RowBox[{"S", ",", "0"}], "]"}], "]"}]}], ")"}]}], ")"}], 
                 ",", 
                 RowBox[{"KroneckerProduct", "[", 
                  RowBox[{
                   RowBox[{"Range", "[", 
                    RowBox[{"tsimpcrank", "[", 
                    RowBox[{"S", ",", "1"}], "]"}], "]"}], ",", 
                   RowBox[{"ConstantArray", "[", 
                    RowBox[{"1", ",", 
                    RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}]}], "}"}], 
               "]"}]}], ",", 
             RowBox[{"ConstantArray", "[", 
              RowBox[{
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"-", "1"}], ")"}], "^", "i"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"tsimpcrank", "[", 
                 RowBox[{"S", ",", "1"}], "]"}], "}"}]}], "]"}]}], "}"}], 
           "]"}]}], ")"}]}], ")"}]}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"tsimpcrank", "[", 
        RowBox[{"S", ",", "0"}], "]"}], ",", 
       RowBox[{"tsimpcrank", "[", 
        RowBox[{"S", ",", "1"}], "]"}]}], "}"}]}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tsimpboundary", "[", 
   RowBox[{"S_", ",", "n_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"tsimpboundary", "[", 
    RowBox[{"S", ",", "n"}], "]"}], "=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"n", "\[Equal]", "0"}], "||", 
      RowBox[{"n", ">", 
       RowBox[{"tsimpdim", "[", "S", "]"}]}]}], ",", 
     RowBox[{"{", "}"}], ",", 
     RowBox[{"SparseArray", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "\[Rule]", 
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "&"}], "/@", 
        RowBox[{"(", 
         RowBox[{"Union", "@@", 
          RowBox[{"(", 
           RowBox[{"Transpose", "/@", 
            RowBox[{"Transpose", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Transpose", "/@", 
                RowBox[{"Transpose", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"Flatten", "/@", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"Sort", "/@", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"___", ",", "i", ",", "___"}], "}"}]}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Union", "@@", "#"}]}], "}"}]}], "]"}]}], ")"}], 
                    "&"}], "/@", 
                    RowBox[{"tsimplices", "[", 
                    RowBox[{"S", ",", "n"}], "]"}]}], "/.", 
                    RowBox[{"PositionIndex", "[", 
                    RowBox[{"tsimplices", "[", 
                    RowBox[{"S", ",", 
                    RowBox[{"n", "-", "1"}]}], "]"}], "]"}]}], ")"}]}], ")"}],
                    ",", 
                   RowBox[{"KroneckerProduct", "[", 
                    RowBox[{
                    RowBox[{"Range", "[", 
                    RowBox[{"tsimpcrank", "[", 
                    RowBox[{"S", ",", "n"}], "]"}], "]"}], ",", 
                    RowBox[{"ConstantArray", "[", 
                    RowBox[{"1", ",", 
                    RowBox[{"{", 
                    RowBox[{"n", "+", "1"}], "}"}]}], "]"}]}], "]"}]}], "}"}],
                  "]"}]}], ",", 
               RowBox[{"ConstantArray", "[", 
                RowBox[{
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"-", "1"}], ")"}], "^", "i"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"i", ",", "1", ",", 
                    RowBox[{"n", "+", "1"}]}], "}"}]}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"tsimpcrank", "[", 
                   RowBox[{"S", ",", "n"}], "]"}], "}"}]}], "]"}]}], "}"}], 
             "]"}]}], ")"}]}], ")"}]}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"tsimpcrank", "[", 
          RowBox[{"S", ",", 
           RowBox[{"n", "-", "1"}]}], "]"}], ",", 
         RowBox[{"tsimpcrank", "[", 
          RowBox[{"S", ",", "n"}], "]"}]}], "}"}]}], "]"}]}], 
    "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.764332609238719*^9, 3.76433261386352*^9}, {
   3.764333540367168*^9, 3.764333544873763*^9}, {3.7652203243458567`*^9, 
   3.76522032626371*^9}, {3.765220454864979*^9, 3.7652204657133923`*^9}, {
   3.7652211910116196`*^9, 3.7652211925612516`*^9}, {3.765221256484152*^9, 
   3.7652212690791197`*^9}, 3.7652215219878464`*^9, {3.7652215804657955`*^9, 
   3.765221672931899*^9}, {3.7652220037586184`*^9, 3.7652220224624915`*^9}, {
   3.7652234773793726`*^9, 3.765223481767899*^9}, 3.7652235290747223`*^9, {
   3.7652235673343368`*^9, 3.7652235821206455`*^9}, {3.7912197151078124`*^9, 
   3.791219793671007*^9}, {3.7912212957724895`*^9, 3.79122129896136*^9}, {
   3.791221348628412*^9, 3.7912215097749414`*^9}},
 CellLabel->
  "In[218]:=",ExpressionUUID->"d8a35d43-c8c1-42c2-9d95-22cd2bc3fd40"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"tsimprank", "[", 
   RowBox[{"S_", ",", "n_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"tsimprank", "[", 
    RowBox[{"S", ",", "n"}], "]"}], "=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"n", "\[Equal]", "0"}], "||", 
      RowBox[{
       RowBox[{"tsimplices", "[", 
        RowBox[{"S", ",", "n"}], "]"}], "\[Equal]", 
       RowBox[{"{", "}"}]}]}], ",", "0", ",", 
     RowBox[{"MatrixRank", "[", 
      RowBox[{"tsimpboundary", "[", 
       RowBox[{"S", ",", "n"}], "]"}], "]"}]}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tsimprank", "[", 
   RowBox[{"S_", ",", "n_", ",", "p_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"tsimprank", "[", 
    RowBox[{"S", ",", "n", ",", "p"}], "]"}], "=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"n", "\[Equal]", "0"}], "||", 
      RowBox[{
       RowBox[{"tsimplices", "[", 
        RowBox[{"S", ",", "n"}], "]"}], "\[Equal]", 
       RowBox[{"{", "}"}]}]}], ",", "0", ",", 
     RowBox[{"MatrixRank", "[", 
      RowBox[{
       RowBox[{"tsimpboundary", "[", 
        RowBox[{"S", ",", "n"}], "]"}], ",", 
       RowBox[{"Modulus", "\[Rule]", "p"}]}], "]"}]}], "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.7515221896244507`*^9, 3.751522194782812*^9}, {
  3.7537878476371512`*^9, 3.753787863213022*^9}, {3.7544758881322217`*^9, 
  3.7544759017001085`*^9}, {3.756556781389573*^9, 3.7565568142757196`*^9}, {
  3.756557035478731*^9, 3.756557040043825*^9}, {3.756557137376872*^9, 
  3.7565571535895596`*^9}, {3.756558774915702*^9, 3.7565587906599307`*^9}, {
  3.7912215435786867`*^9, 3.7912215582916307`*^9}},
 CellLabel->
  "In[220]:=",ExpressionUUID->"e9c28bf7-b741-4cf8-880a-687cbb0c3345"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"tsimpbetti", "[", 
   RowBox[{"S_", ",", "n_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"tsimpbetti", "[", 
    RowBox[{"S", ",", "n"}], "]"}], "=", 
   RowBox[{
    RowBox[{"tsimpcrank", "[", 
     RowBox[{"S", ",", "n"}], "]"}], "-", 
    RowBox[{"tsimprank", "[", 
     RowBox[{"S", ",", "n"}], "]"}], "-", 
    RowBox[{"tsimprank", "[", 
     RowBox[{"S", ",", 
      RowBox[{"n", "+", "1"}]}], "]"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tsimpbetti", "[", 
   RowBox[{"S_", ",", "n_", ",", "p_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"tsimpbetti", "[", 
    RowBox[{"S", ",", "n", ",", "p"}], "]"}], "=", 
   RowBox[{
    RowBox[{"tsimpcrank", "[", 
     RowBox[{"S", ",", "n"}], "]"}], "-", 
    RowBox[{"tsimprank", "[", 
     RowBox[{"S", ",", "n", ",", "p"}], "]"}], "-", 
    RowBox[{"tsimprank", "[", 
     RowBox[{"S", ",", 
      RowBox[{"n", "+", "1"}], ",", "p"}], "]"}]}]}]}]}], "Input",
 CellChangeTimes->{{3.708699579685809*^9, 3.7086995925725465`*^9}, {
  3.708699741561068*^9, 3.708699770073699*^9}, {3.708699940019419*^9, 
  3.7086999484739027`*^9}, {3.708700017681861*^9, 3.7087000200459967`*^9}, {
  3.7360054958237677`*^9, 3.736005510409794*^9}, {3.73601502796562*^9, 
  3.7360150920102835`*^9}, {3.7515219667839575`*^9, 3.7515219704249797`*^9}, {
  3.753787867139542*^9, 3.7537878759842205`*^9}, {3.754475904733552*^9, 
  3.7544759201311865`*^9}, {3.7565568226124396`*^9, 3.756556852066044*^9}, {
  3.756556882072188*^9, 3.756556887644754*^9}, {3.7565570480066495`*^9, 
  3.756557054367593*^9}, {3.7565587967743626`*^9, 3.756558825803094*^9}, {
  3.791221559770063*^9, 3.791221578656532*^9}},
 CellLabel->
  "In[222]:=",ExpressionUUID->"0de766f2-e3c2-42f8-95cb-1a4b34e66831"],

Cell[BoxData[
 RowBox[{
  RowBox[{"tsimptorsion", "[", 
   RowBox[{"S_", ",", "n_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"tsimptorsion", "[", 
    RowBox[{"S", ",", "n"}], "]"}], "=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"0", "<", "n", "<", 
      RowBox[{"tsimpdim", "[", "S", "]"}]}], ",", 
     RowBox[{"Select", "[", 
      RowBox[{
       RowBox[{"Diagonal", "[", 
        RowBox[{
         RowBox[{"SmithDecomposition", "[", 
          RowBox[{"tsimpboundary", "[", 
           RowBox[{"S", ",", 
            RowBox[{"n", "+", "1"}]}], "]"}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"#", ">", "1"}], "&"}]}], "]"}], ",", 
     RowBox[{"{", "}"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.754208643928368*^9, 3.7542086531010437`*^9}, {
   3.754208946408475*^9, 3.7542089674989367`*^9}, {3.7542089993934855`*^9, 
   3.754209045702162*^9}, {3.754209078242995*^9, 3.7542091084718113`*^9}, {
   3.754209324075686*^9, 3.754209339228257*^9}, {3.754209375603123*^9, 
   3.7542093846799135`*^9}, {3.7542094532460003`*^9, 3.754209453415701*^9}, 
   3.754209529526456*^9, {3.754210074544213*^9, 3.7542100805863466`*^9}, {
   3.7544759231159105`*^9, 3.7544759314883895`*^9}, {3.756556893349178*^9, 
   3.756556902045453*^9}, {3.756557172176654*^9, 3.756557181530848*^9}, {
   3.791221581129648*^9, 3.7912215876905527`*^9}},
 CellLabel->
  "In[224]:=",ExpressionUUID->"7fd3fe47-f2da-4c90-b57f-931f9c0816fb"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"tsimphomology", "[", "S_", "]"}], ":=", 
  RowBox[{
   RowBox[{"tsimphomology", "[", "S", "]"}], "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"tsimpbetti", "[", 
      RowBox[{"S", ",", "j"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "0", ",", 
       RowBox[{"tsimpdim", "[", "S", "]"}]}], "}"}]}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tsimphomology", "[", 
   RowBox[{"S_", ",", "p_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"tsimphomology", "[", 
    RowBox[{"S", ",", "p"}], "]"}], "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"tsimpbetti", "[", 
      RowBox[{"S", ",", "j", ",", "p"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "0", ",", 
       RowBox[{"tsimpdim", "[", "S", "]"}]}], "}"}]}], "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.7565587434528995`*^9, 3.756558747372207*^9}, {
  3.7565596533685484`*^9, 3.7565596640296884`*^9}, {3.7912215891517124`*^9, 
  3.7912216001351857`*^9}, {3.798364013845084*^9, 3.7983640235423594`*^9}, {
  3.798366099736655*^9, 3.7983661073645983`*^9}},
 CellLabel->
  "In[225]:=",ExpressionUUID->"8c5b07b2-5971-4ed2-80b6-56815e3388a1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ntsimprank", "[", 
   RowBox[{"S_", ",", "n_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"ntsimprank", "[", 
    RowBox[{"S", ",", "n"}], "]"}], "=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"n", "\[Equal]", "0"}], "||", 
      RowBox[{
       RowBox[{"tsimplices", "[", 
        RowBox[{"S", ",", "n"}], "]"}], "\[Equal]", 
       RowBox[{"{", "}"}]}]}], ",", "0", ",", 
     RowBox[{"Length", "[", 
      RowBox[{"SingularValueList", "[", 
       RowBox[{"N", "[", 
        RowBox[{"tsimpboundary", "[", 
         RowBox[{"S", ",", "n"}], "]"}], "]"}], "]"}], "]"}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.756556939866056*^9, 3.756556960447392*^9}, {
  3.756557206000186*^9, 3.7565572416196804`*^9}, {3.756558839702592*^9, 
  3.7565588439067826`*^9}, {3.7912216072646494`*^9, 3.7912216125747366`*^9}},
 CellLabel->
  "In[227]:=",ExpressionUUID->"dfda592d-cb62-45f8-ba38-4644ceb4896f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ntsimpbetti", "[", 
   RowBox[{"S_", ",", "n_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"ntsimpbetti", "[", 
    RowBox[{"S", ",", "n"}], "]"}], "=", 
   RowBox[{
    RowBox[{"tsimpcrank", "[", 
     RowBox[{"S", ",", "n"}], "]"}], "-", 
    RowBox[{"ntsimprank", "[", 
     RowBox[{"S", ",", "n"}], "]"}], "-", 
    RowBox[{"ntsimprank", "[", 
     RowBox[{"S", ",", 
      RowBox[{"n", "+", "1"}]}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.7565569545955687`*^9, 3.75655695694556*^9}, {
  3.7565572496105657`*^9, 3.756557259975773*^9}, {3.756558851085614*^9, 
  3.7565588631312404`*^9}, {3.7912216156805058`*^9, 3.791221625184951*^9}},
 CellLabel->
  "In[228]:=",ExpressionUUID->"517dd0c7-f250-410b-ba7c-9375cf12bfda"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ntsimphomology", "[", "S_", "]"}], ":=", 
  RowBox[{
   RowBox[{"ntsimphomology", "[", "S", "]"}], "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"ntsimpbetti", "[", 
      RowBox[{"S", ",", "j"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "0", ",", 
       RowBox[{"tsimpdim", "[", "S", "]"}]}], "}"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.7565586501522827`*^9, 3.756558677775174*^9}, {
  3.7912216269203367`*^9, 3.7912216308108287`*^9}, {3.798364030212284*^9, 
  3.7983640326600714`*^9}, {3.798366087368152*^9, 3.798366089823798*^9}},
 CellLabel->
  "In[229]:=",ExpressionUUID->"304dfec1-6788-41a6-a762-99914d810b49"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"Local", " ", "directionality", " ", "filtration"}], ",", " ", 
   RowBox[{"3", "-", 
    RowBox[{
    "cycle", " ", "filtration", " ", "and", " ", "the", " ", "corresponding", 
     " ", 
     RowBox[{"bifiltration", "."}]}]}]}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.798366242840121*^9, 3.798366266766505*^9}},
 CellLabel->
  "In[230]:=",ExpressionUUID->"49d1990d-7108-4a13-8f4c-2de92e0280f7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"locfiltration", "[", 
   RowBox[{"S_", ",", "d_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"locfiltration", "[", 
    RowBox[{"S", ",", "d"}], "]"}], "=", 
   RowBox[{"Select", "[", 
    RowBox[{
     RowBox[{"tsimplices", "[", "S", "]"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"locdir", "[", "#", "]"}], "\[LessEqual]", "d"}], "&"}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.791228709552121*^9, 3.7912287804731917`*^9}, {
  3.791236129105192*^9, 3.7912361353894243`*^9}, {3.7983662732050247`*^9, 
  3.798366282179689*^9}},
 CellLabel->
  "In[231]:=",ExpressionUUID->"4465c9c6-64a1-43d9-91ed-2f1ef573bb42"],

Cell[BoxData[
 RowBox[{
  RowBox[{"c3filtration", "[", 
   RowBox[{"S_", ",", "j_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"c3filtration", "[", 
    RowBox[{"S", ",", "j"}], "]"}], "=", 
   RowBox[{"Select", "[", 
    RowBox[{
     RowBox[{"tsimplices", "[", "S", "]"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"c3dir", "[", "#", "]"}], "\[LessEqual]", "j"}], "&"}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.791228788993186*^9, 3.791228805031745*^9}, {
  3.7912361394147635`*^9, 3.7912361443712974`*^9}},
 CellLabel->
  "In[232]:=",ExpressionUUID->"2021634e-9119-4271-8112-97f7db03770c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"bifiltration", "[", 
   RowBox[{"S_", ",", "d_", ",", "j_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"bifiltration", "[", 
    RowBox[{"S", ",", "d", ",", "j"}], "]"}], "=", 
   RowBox[{"Select", "[", 
    RowBox[{
     RowBox[{"tsimplices", "[", "S", "]"}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"locdir", "[", "#", "]"}], "\[LessEqual]", "d"}], "&&", 
        RowBox[{
         RowBox[{"c3dir", "[", "#", "]"}], "\[LessEqual]", "j"}]}], ")"}], 
      "&"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.7912288084176235`*^9, 3.7912288402141027`*^9}, {
  3.7912361485018253`*^9, 3.791236154971142*^9}, {3.798366290031315*^9, 
  3.7983662919260473`*^9}},
 CellLabel->
  "In[233]:=",ExpressionUUID->"7469f63d-8640-4876-9dd3-3e7274f3b9ed"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
  "When", " ", "using", " ", "Algebraic", " ", "Morse", " ", "Theory", " ", 
   "computations", " ", "as", " ", "described", " ", "in", " ", "the", " ", 
   "paper", " ", 
   "\"\<Leon Lampret. Chain complex reduction using steepness matchings. \
Preprint, available\nat arXiv:1903.00783 [math.AT], 2019,\>\"", " ", "the", 
   " ", "following", " ", "functions", " ", "are", " ", "useful", " ", "to", 
   " ", "calculate", " ", "the", " ", "rational", " ", "Betti", " ", 
   "numbers", " ", "and", " ", "torsion", " ", "coefficients", " ", "of", " ",
    "the", " ", "reduced", " ", "chain", " ", "complex", " ", 
   RowBox[{"explicitly", "."}]}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.7983746960061426`*^9, 3.7983746979808893`*^9}, {
   3.7983747614362116`*^9, 3.7983748814973745`*^9}, {3.798374920224684*^9, 
   3.7983749221792173`*^9}, 3.7983749784654355`*^9},
 CellLabel->
  "In[234]:=",ExpressionUUID->"287465f1-9254-4274-90e6-370059b82730"],

Cell[BoxData[
 RowBox[{
  RowBox[{"bdryrank", "[", "A_", "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Flatten", "[", "A", "]"}], "\[NotEqual]", 
     RowBox[{"{", "}"}]}], ",", 
    RowBox[{"MatrixRank", "[", "A", "]"}], ",", "0"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.764097315809891*^9, 3.764097385876353*^9}},
 CellLabel->
  "In[235]:=",ExpressionUUID->"1c5913fc-6679-451f-aa63-2a80743d235e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"chcxbetti", "[", 
   RowBox[{"dims_", ",", "bdrs_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"dims", "-", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Append", "[", 
        RowBox[{"#", ",", "0"}], "]"}], "+", 
       RowBox[{"Prepend", "[", 
        RowBox[{"#", ",", "0"}], "]"}]}], ")"}]}], "&"}], "[", 
   RowBox[{"bdryrank", "/@", "bdrs"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.764097270096341*^9, 3.764097285858633*^9}, {
  3.764097393365511*^9, 3.764097396850623*^9}, {3.7640975512711735`*^9, 
  3.7640975828723783`*^9}},
 CellLabel->
  "In[236]:=",ExpressionUUID->"bd3d567a-08ef-488b-a1e0-f27195597732"],

Cell[BoxData[
 RowBox[{
  RowBox[{"chcxtorsion", "[", 
   RowBox[{"dims_", ",", "bdrs_"}], "]"}], ":=", 
  RowBox[{"Append", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Select", "[", 
       RowBox[{"#", ",", 
        RowBox[{
         RowBox[{"#", ">", "1"}], "&"}]}], "]"}], "&"}], "/@", 
     RowBox[{"(", 
      RowBox[{"Diagonal", "/@", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Flatten", "[", "#", "]"}], "\[NotEqual]", 
             RowBox[{"{", "}"}]}], ",", 
            RowBox[{
             RowBox[{"SmithDecomposition", "[", "#", "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", 
            RowBox[{"{", "}"}]}], "]"}], "&"}], "/@", "bdrs"}], ")"}]}], 
      ")"}]}], ",", 
    RowBox[{"{", "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.764097587274499*^9, 3.764097734543005*^9}, {
  3.764097768133794*^9, 3.7640978473236046`*^9}, {3.7640978928472786`*^9, 
  3.7640979634122906`*^9}},
 CellLabel->
  "In[237]:=",ExpressionUUID->"f9459810-6c7a-47e0-86c6-a167563867db"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{
   "Persistent", " ", "homology", " ", "with", " ", "respect", " ", "to", " ",
     "the", " ", "local", " ", "directionality", " ", "filtration"}], ",", 
   " ", 
   RowBox[{
   "based", " ", "on", " ", 
    "\"\<Vin de Silva, Dmitriy Morozov and Mikael Vejdemo-Johansson. \
Dualities in persistent (co)homology. Preprint, available at arXiv:1107.5665 \
[math.AT], 2011.\>\""}]}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.798381188644457*^9, 3.798381206618907*^9}, {
  3.798381433567004*^9, 3.798381448088172*^9}},
 CellLabel->
  "In[238]:=",ExpressionUUID->"108e5279-c0c6-44d0-8e6e-12e3652af963"],

Cell[BoxData[
 RowBox[{
  RowBox[{"fulltsimpboundary", "[", "S_", "]"}], ":=", 
  RowBox[{"ArrayFlatten", "[", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"j", "\[Equal]", 
        RowBox[{"i", "+", "1"}]}], ",", 
       RowBox[{"tsimpboundary", "[", 
        RowBox[{"S", ",", "i"}], "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"Length", "[", 
           RowBox[{"tsimplices", "[", 
            RowBox[{"S", ",", 
             RowBox[{"i", "-", "1"}]}], "]"}], "]"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"Length", "[", 
           RowBox[{"tsimplices", "[", 
            RowBox[{"S", ",", 
             RowBox[{"j", "-", "1"}]}], "]"}], "]"}], "}"}]}], "]"}]}], "]"}],
      ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{
        RowBox[{"tsimpdim", "[", "S", "]"}], "+", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", 
       RowBox[{
        RowBox[{"tsimpdim", "[", "S", "]"}], "+", "1"}]}], "}"}]}], "]"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.7403123433966713`*^9, 3.7403124219568853`*^9}, {
  3.74031256186946*^9, 3.7403125723625655`*^9}, {3.7403937459645414`*^9, 
  3.740393752906007*^9}, {3.7403938102961593`*^9, 3.740393862894494*^9}, {
  3.7403939086873503`*^9, 3.740393946550585*^9}, {3.740393983019332*^9, 
  3.740393988209386*^9}, {3.7403940387693357`*^9, 3.7403940414035916`*^9}, {
  3.740394141827756*^9, 3.7403941439771056`*^9}, {3.7403942195029783`*^9, 
  3.740394245028211*^9}, {3.740394329002684*^9, 3.7403943310722327`*^9}, {
  3.7486961203308144`*^9, 3.748696124082095*^9}, {3.798381551948244*^9, 
  3.7983815585168095`*^9}, {3.798381630736547*^9, 3.7983816332076206`*^9}, {
  3.7983816973305063`*^9, 3.7983817348504105`*^9}},
 CellLabel->
  "In[239]:=",ExpressionUUID->"560b720b-7a66-47fd-8d2e-0f12a0bcbb07"],

Cell[BoxData[
 RowBox[{
  RowBox[{"low", "[", "v_", "]"}], ":=", 
  RowBox[{"Max", "[", 
   RowBox[{"Complement", "[", 
    RowBox[{
     RowBox[{"Range", "[", 
      RowBox[{"Length", "[", "v", "]"}], "]"}], ",", 
     RowBox[{"Union", "@@", 
      RowBox[{"Position", "[", 
       RowBox[{"v", ",", "0"}], "]"}]}]}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7397755926234727`*^9, 3.7397756223438425`*^9}, {
   3.739775722433589*^9, 3.7397757363954906`*^9}, 3.7397759073415737`*^9, {
   3.73977615696761*^9, 3.7397761919559956`*^9}},
 CellLabel->
  "In[240]:=",ExpressionUUID->"6a59e213-54b6-4ab5-bc13-c4f515ca401b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"pairing", "[", "l_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"P", "=", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"n", "=", 
       RowBox[{"Length", "[", "l", "]"}]}], ",", "i"}], "}"}], ",", 
    RowBox[{
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", "n"}], ",", 
       RowBox[{"i", "++"}], ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"l", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}],
           "\[NotEqual]", 
          RowBox[{"-", "\[Infinity]"}]}], ",", 
         RowBox[{"P", "=", 
          RowBox[{"Append", "[", 
           RowBox[{"P", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
              "l", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
              ",", "i"}], "}"}]}], "]"}]}]}], "]"}]}], "]"}], ";", 
     RowBox[{"Return", "[", 
      RowBox[{"Union", "[", 
       RowBox[{"P", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"#", ",", "\[Infinity]"}], "}"}], "&"}], "/@", 
         RowBox[{"Complement", "[", 
          RowBox[{
           RowBox[{"Range", "[", "n", "]"}], ",", 
           RowBox[{"Union", "@@", "P"}]}], "]"}]}]}], "]"}], "]"}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.739882595417827*^9, 3.7398829195199904`*^9}},
 CellLabel->
  "In[241]:=",ExpressionUUID->"dd229eab-54e1-44e5-85e5-0ba058cdddb4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"pHcol", "[", "D_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"i", ",", 
      RowBox[{"R", "=", "D"}], ",", 
      RowBox[{"n", "=", 
       RowBox[{"Length", "[", "D", "]"}]}], ",", "V", ",", "lowR", ",", "c", 
      ",", "j"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"V", "=", 
      RowBox[{"IdentityMatrix", "[", "n", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"lowR", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"low", "[", 
         RowBox[{"D", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "i"}], "\[RightDoubleBracket]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", "n"}], ",", 
       RowBox[{"i", "++"}], ",", 
       RowBox[{"While", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
          "lowR", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
          "\[NotEqual]", 
          RowBox[{"-", "\[Infinity]"}]}], ",", 
         RowBox[{
          RowBox[{"j", "=", 
           RowBox[{"Min", "[", 
            RowBox[{"Union", "@@", 
             RowBox[{"Position", "[", 
              RowBox[{
               RowBox[{"Take", "[", 
                RowBox[{"lowR", ",", 
                 RowBox[{"i", "-", "1"}]}], "]"}], ",", 
               RowBox[{
               "lowR", "\[LeftDoubleBracket]", "i", 
                "\[RightDoubleBracket]"}]}], "]"}]}], "]"}]}], ";", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"j", "\[Equal]", "\[Infinity]"}], ",", 
            RowBox[{"Break", "[", "]"}]}], "]"}], ";", 
          RowBox[{"c", "=", 
           RowBox[{
            RowBox[{"R", "\[LeftDoubleBracket]", 
             RowBox[{
              RowBox[{
              "lowR", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
              ",", "i"}], "\[RightDoubleBracket]"}], "/", 
            RowBox[{"R", "\[LeftDoubleBracket]", 
             RowBox[{
              RowBox[{
              "lowR", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}], 
              ",", "j"}], "\[RightDoubleBracket]"}]}]}], ";", 
          RowBox[{
           RowBox[{"R", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "i"}], "\[RightDoubleBracket]"}], "=", 
           RowBox[{
            RowBox[{"R", "\[LeftDoubleBracket]", 
             RowBox[{"All", ",", "i"}], "\[RightDoubleBracket]"}], "-", 
            RowBox[{"c", " ", 
             RowBox[{"R", "\[LeftDoubleBracket]", 
              RowBox[{"All", ",", "j"}], "\[RightDoubleBracket]"}]}]}]}], ";",
           "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
           "lowR", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
           "=", 
           RowBox[{"low", "[", 
            RowBox[{"R", "\[LeftDoubleBracket]", 
             RowBox[{"All", ",", "i"}], "\[RightDoubleBracket]"}], "]"}]}], 
          ";", 
          RowBox[{
           RowBox[{"V", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "i"}], "\[RightDoubleBracket]"}], "=", 
           RowBox[{
            RowBox[{"V", "\[LeftDoubleBracket]", 
             RowBox[{"All", ",", "i"}], "\[RightDoubleBracket]"}], "-", 
            RowBox[{"c", " ", 
             RowBox[{"V", "\[LeftDoubleBracket]", 
              RowBox[{"All", ",", "j"}], "\[RightDoubleBracket]"}]}]}]}]}]}], 
        "]"}]}], "]"}], ";", 
     RowBox[{"Return", "[", 
      RowBox[{"pairing", "[", "lowR", "]"}], "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.73988343350414*^9, 3.7398834394461803`*^9}, {
  3.740399743625641*^9, 3.740399774185328*^9}},
 CellLabel->
  "In[242]:=",ExpressionUUID->"ed78f8bb-e4d2-4a29-83c5-1b2f4aacc7f0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"locfilt", "[", "e_", "]"}], ":=", 
  RowBox[{"locdir", "/@", 
   RowBox[{"fullflagtplx", "[", "e", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.7983812582400084`*^9, 3.7983812660523806`*^9}},
 CellLabel->
  "In[243]:=",ExpressionUUID->"3f109a5f-0b4c-4ead-a11a-0bddef6f77b6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"locsort", "[", "edges_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"filt", "=", 
       RowBox[{"locfilt", "[", "edges", "]"}]}], ",", "indices", ",", "n", 
      ",", "i", ",", 
      RowBox[{"cplx", "=", 
       RowBox[{"fullflagtplx", "[", "edges", "]"}]}], ",", 
      RowBox[{"permcplx", "=", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"perm", "=", 
       RowBox[{"{", "}"}]}], ",", "pos"}], "}"}], ",", 
    RowBox[{
     RowBox[{"indices", "=", 
      RowBox[{"Union", "[", "filt", "]"}]}], ";", 
     RowBox[{"n", "=", 
      RowBox[{"Length", "[", "indices", "]"}]}], ";", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", "n"}], ",", 
       RowBox[{"i", "++"}], ",", 
       RowBox[{
        RowBox[{"pos", "=", 
         RowBox[{"Union", "@@", 
          RowBox[{"Position", "[", 
           RowBox[{"filt", ",", 
            RowBox[{"indices", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}]}], ";", 
        RowBox[{"permcplx", "=", 
         RowBox[{"Join", "[", 
          RowBox[{"permcplx", ",", 
           RowBox[{"cplx", "[", 
            RowBox[{"[", "pos", "]"}], "]"}]}], "]"}]}], ";", 
        RowBox[{"perm", "=", 
         RowBox[{"Join", "[", 
          RowBox[{"perm", ",", "pos"}], "]"}]}]}]}], "]"}], ";", 
     RowBox[{"Return", "[", 
      RowBox[{"{", 
       RowBox[{"permcplx", ",", "perm"}], "}"}], "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.740677863150432*^9, 3.740677869359243*^9}, {
  3.7983812107912364`*^9, 3.7983812743709574`*^9}},
 CellLabel->
  "In[244]:=",ExpressionUUID->"d6e31370-efb0-4a82-b080-b7a0be5f461a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"locpers", "[", "edges_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"dim", "=", 
       RowBox[{"sdim", "/@", 
        RowBox[{"fullflagtplx", "[", "edges", "]"}]}]}], ",", 
      RowBox[{"filt", "=", 
       RowBox[{"Sort", "[", 
        RowBox[{"locfilt", "[", "edges", "]"}], "]"}]}], ",", 
      RowBox[{"perm", "=", 
       RowBox[{
        RowBox[{"locsort", "[", "edges", "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ",", 
      RowBox[{"M", "=", 
       RowBox[{"fulltsimpboundary", "[", 
        RowBox[{"fullflagtplx", "[", "edges", "]"}], "]"}]}], ",", "n", ",", 
      "barcode", ",", "birth"}], "}"}], ",", 
    RowBox[{
     RowBox[{"n", "=", 
      RowBox[{"Length", "[", "filt", "]"}]}], ";", 
     RowBox[{"M", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"M", "[", 
         RowBox[{"[", "i", "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "perm"}], "}"}]}], "]"}]}], ";", 
     RowBox[{"M", "=", 
      RowBox[{"Transpose", "[", "M", "]"}]}], ";", 
     RowBox[{"M", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"M", "[", 
         RowBox[{"[", "i", "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "perm"}], "}"}]}], "]"}]}], ";", 
     RowBox[{"M", "=", 
      RowBox[{"Transpose", "[", "M", "]"}]}], ";", 
     RowBox[{"dim", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"dim", "[", 
         RowBox[{"[", "i", "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "perm"}], "}"}]}], "]"}]}], ";", 
     RowBox[{"barcode", "=", 
      RowBox[{"pHcol", "[", "M", "]"}]}], ";", 
     RowBox[{"birth", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "&"}], "/@", "barcode"}]}], ";", 
     RowBox[{"Return", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"barcode", "/.", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"i", "\[Rule]", 
            RowBox[{"filt", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ",", 
        RowBox[{"dim", "[", 
         RowBox[{"[", "birth", "]"}], "]"}]}], "}"}], "]"}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.7406880402834797`*^9, 3.7406880656647243`*^9}, {
  3.748696138233403*^9, 3.7486961391686153`*^9}, {3.7983814532884245`*^9, 
  3.7983814692965865`*^9}, {3.798381583912535*^9, 3.7983815962131605`*^9}},
 CellLabel->
  "In[245]:=",ExpressionUUID->"fccc4dff-4655-4ae9-b8d8-80a79c8f740c"]
},
WindowSize->{775, 657},
WindowMargins->{{163, Automatic}, {51, Automatic}},
FrontEndVersion->"11.3 for Microsoft Windows (64-bit) (March 6, 2018)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 435, 8, 28, "Input",ExpressionUUID->"d0de7dd1-7b12-4b8b-af6c-56973703c3e0"],
Cell[996, 30, 3014, 43, 219, "Input",ExpressionUUID->"0968a459-b601-484c-934e-c37a2ad72515"],
Cell[4013, 75, 1416, 25, 105, "Input",ExpressionUUID->"d3d0c678-1fd7-4665-91d2-f07568139f40"],
Cell[5432, 102, 396, 11, 28, "Input",ExpressionUUID->"d2fb68bd-da7f-4bd8-9c73-f82da60857e5"],
Cell[5831, 115, 2706, 63, 143, "Input",ExpressionUUID->"87dea68a-4aaa-465e-a8c6-004799ceaac1"],
Cell[8540, 180, 997, 24, 48, "Input",ExpressionUUID->"9aa47d56-60e6-49fa-b87a-0d32be7bb6e8"],
Cell[9540, 206, 612, 15, 28, "Input",ExpressionUUID->"41ab6c0b-0c83-4e3d-a591-6911e3987ebf"],
Cell[10155, 223, 2299, 41, 200, "Input",ExpressionUUID->"47ba5779-4bf6-4b68-a440-765bfac1efde"],
Cell[12457, 266, 1046, 30, 48, "Input",ExpressionUUID->"f371d8ae-4249-4e69-bb49-d2d54f9f1258"],
Cell[13506, 298, 433, 11, 28, "Input",ExpressionUUID->"eed7d771-8524-4a7d-97ff-053fb34ca93f"],
Cell[13942, 311, 1626, 38, 48, "Input",ExpressionUUID->"9d511a95-6838-42f0-911f-c8ef483348b6"],
Cell[15571, 351, 448, 12, 28, "Input",ExpressionUUID->"bceaf04c-78b8-42c1-ae2f-41b5d71a6bba"],
Cell[16022, 365, 4309, 101, 257, "Input",ExpressionUUID->"1ba52779-230a-40cb-bf04-3f05ea2eb784"],
Cell[20334, 468, 1667, 44, 105, "Input",ExpressionUUID->"bc75a8ae-ed76-412f-9c90-b122fec401c5"],
Cell[22004, 514, 1688, 39, 67, "Input",ExpressionUUID->"f503ad48-e739-4004-9174-1fe925eb4796"],
Cell[23695, 555, 1421, 32, 86, "Input",ExpressionUUID->"4bdf224b-3445-4e84-8b41-6907a68ffe48"],
Cell[25119, 589, 1125, 30, 48, "Input",ExpressionUUID->"b7791bef-b8b1-43a7-9e26-50ec43cb3677"],
Cell[26247, 621, 898, 25, 67, "Input",ExpressionUUID->"261ead85-a6fd-45c0-b591-fe85a2a32363"],
Cell[27148, 648, 704, 19, 28, "Input",ExpressionUUID->"ff1a517b-d757-4391-b471-06318ce8b4b1"],
Cell[27855, 669, 639, 16, 28, "Input",ExpressionUUID->"d86ab14f-affc-4737-85dd-539a1fbf0cfc"],
Cell[28497, 687, 1627, 29, 124, "Input",ExpressionUUID->"e209aaf4-6651-4f34-8d68-69f70fa1fa51"],
Cell[30127, 718, 487, 15, 28, "Input",ExpressionUUID->"16fd4255-5596-49d5-a533-f1daf4a125e3"],
Cell[30617, 735, 2356, 64, 143, "Input",ExpressionUUID->"c1743ea1-ba54-482d-ba95-e1dd2150f75b"],
Cell[32976, 801, 533, 14, 28, "Input",ExpressionUUID->"25f45974-06bb-4ff8-9754-a76a92f05a48"],
Cell[33512, 817, 1084, 22, 28, "Input",ExpressionUUID->"ee5a6016-a107-462f-b76e-33209794f101"],
Cell[34599, 841, 506, 11, 28, "Input",ExpressionUUID->"e1dd0764-08ed-4991-b81f-55d9c38ca97b"],
Cell[35108, 854, 781, 19, 48, "Input",ExpressionUUID->"d14ea0fe-4d0f-4018-a418-85c78941d453"],
Cell[35892, 875, 642, 16, 28, "Input",ExpressionUUID->"0e2c3400-e7d3-44b3-a5a9-04ed9e23fa5b"],
Cell[36537, 893, 3959, 98, 238, "Input",ExpressionUUID->"ee1453cf-0b2f-4cbb-a5c9-3f1503ca93bc"],
Cell[40499, 993, 1293, 35, 105, "Input",ExpressionUUID->"91f52457-2e5e-4000-a508-4dae819db5c2"],
Cell[41795, 1030, 928, 23, 48, "Input",ExpressionUUID->"109ba858-4d98-46a3-9334-801b5fd17439"],
Cell[42726, 1055, 1676, 31, 67, "Input",ExpressionUUID->"6d08066a-c400-401d-8af0-b6b83ff311f4"],
Cell[44405, 1088, 580, 17, 28, "Input",ExpressionUUID->"c7f5d9df-3ebb-4cbe-872a-b6880756924a"],
Cell[44988, 1107, 714, 21, 48, "Input",ExpressionUUID->"c66fb1e4-1900-4f75-be85-473ba38816fb"],
Cell[45705, 1130, 1870, 46, 105, "Input",ExpressionUUID->"41780967-d686-4c54-83f4-495aeeb18b70"],
Cell[47578, 1178, 354, 7, 28, "Input",ExpressionUUID->"8abd2be6-86d8-4242-8a0b-554e8cd97904"],
Cell[47935, 1187, 1569, 42, 143, "Input",ExpressionUUID->"7c4a6870-83dd-4682-910b-2ac76f7d5f16"],
Cell[49507, 1231, 576, 11, 48, "Input",ExpressionUUID->"e9602b85-5c1d-40ca-b427-ea40b3a38e06"],
Cell[50086, 1244, 3363, 78, 162, "Input",ExpressionUUID->"aaf0277e-30a4-432d-a716-325ad3466edd"],
Cell[53452, 1324, 4049, 84, 219, "Input",ExpressionUUID->"fbb496ae-a39f-4b78-acdb-3c5a9f4db875"],
Cell[57504, 1410, 309, 6, 28, "Input",ExpressionUUID->"4d118668-f37a-432d-bb97-e9e65fb8ebfd"],
Cell[57816, 1418, 3966, 96, 238, "Input",ExpressionUUID->"1b75755c-88a1-40a1-b6df-bc7aba0987ae"],
Cell[61785, 1516, 5594, 137, 314, "Input",ExpressionUUID->"0f6bd8ad-7317-4ae0-affc-2b40f9b9446b"],
Cell[67382, 1655, 4686, 109, 390, "Input",ExpressionUUID->"660790d7-4677-463c-aeb6-f0352b252a9e"],
Cell[72071, 1766, 1760, 32, 143, "Input",ExpressionUUID->"f77694f3-e55c-4e40-a1b0-e800da356406"],
Cell[73834, 1800, 423, 9, 28, "Input",ExpressionUUID->"8a34dca7-72bd-41e4-b198-ce4fcfeb26e8"],
Cell[74260, 1811, 1230, 22, 105, "Input",ExpressionUUID->"4ba3fee6-b818-41b4-a874-736b30e20436"],
Cell[75493, 1835, 478, 12, 28, "Input",ExpressionUUID->"651b1f42-d205-498e-8572-d1a877875ffe"],
Cell[75974, 1849, 1119, 33, 86, "Input",ExpressionUUID->"d8b2cefb-8949-46a2-88e5-2fe511dae1d6"],
Cell[77096, 1884, 457, 13, 28, "Input",ExpressionUUID->"48d337e3-a806-4b4c-841c-f11711ced927"],
Cell[77556, 1899, 455, 13, 28, "Input",ExpressionUUID->"9c6d3991-d41f-46bb-88e6-8676d780e947"],
Cell[78014, 1914, 1424, 38, 86, "Input",ExpressionUUID->"015a7150-ec45-4938-89cf-7fd49769a5f8"],
Cell[79441, 1954, 1427, 38, 86, "Input",ExpressionUUID->"dd035d69-4e48-4ca8-ba4f-d062a26a3d05"],
Cell[80871, 1994, 4892, 127, 314, "Input",ExpressionUUID->"778ea909-204a-48db-ad37-839011d1f673"],
Cell[85766, 2123, 649, 20, 48, "Input",ExpressionUUID->"b80b03ba-604f-425c-855a-70d743af20ea"],
Cell[86418, 2145, 564, 15, 28, "Input",ExpressionUUID->"4832ecb9-0bda-4e24-ac5c-6d2be66a740c"],
Cell[86985, 2162, 629, 13, 67, "Input",ExpressionUUID->"7ebc58a4-90e1-4a3c-873c-a731ee24d9c3"],
Cell[87617, 2177, 741, 20, 28, "Input",ExpressionUUID->"e76b04fa-8a94-4886-9449-9f0053ce1ab7"],
Cell[88361, 2199, 1418, 35, 67, "Input",ExpressionUUID->"17429eec-aa0c-41fe-905e-2ad1c76c2a17"],
Cell[89782, 2236, 598, 17, 28, "Input",ExpressionUUID->"508247c4-e75f-4c4a-9d70-be69b67993cf"],
Cell[90383, 2255, 1100, 26, 28, "Input",ExpressionUUID->"3b529ffb-14cc-4f73-80d5-f31366931a26"],
Cell[91486, 2283, 766, 22, 48, "Input",ExpressionUUID->"133a198e-996a-4b54-af41-5f5e4cc43b6f"],
Cell[92255, 2307, 2321, 41, 181, "Input",ExpressionUUID->"ebf85001-9f3c-4a25-a3a1-21214f66f644"],
Cell[94579, 2350, 809, 20, 28, "Input",ExpressionUUID->"e6c59a1d-e555-429a-bd55-3551fd756c11"],
Cell[95391, 2372, 956, 19, 67, "Input",ExpressionUUID->"a7f6a439-a4b5-41e0-bcf4-9a8be53e4851"],
Cell[96350, 2393, 3298, 93, 200, "Input",ExpressionUUID->"599194e6-d0a0-49f8-8bb0-7bc16060fce9"],
Cell[99651, 2488, 502, 13, 28, "Input",ExpressionUUID->"6d0cf0d0-3b16-4944-8d5c-0b91453acf9c"],
Cell[100156, 2503, 7377, 184, 466, "Input",ExpressionUUID->"d8a35d43-c8c1-42c2-9d95-22cd2bc3fd40"],
Cell[107536, 2689, 1728, 45, 105, "Input",ExpressionUUID->"e9c28bf7-b741-4cf8-880a-687cbb0c3345"],
Cell[109267, 2736, 1747, 40, 67, "Input",ExpressionUUID->"0de766f2-e3c2-42f8-95cb-1a4b34e66831"],
Cell[111017, 2778, 1477, 33, 86, "Input",ExpressionUUID->"7fd3fe47-f2da-4c90-b57f-931f9c0816fb"],
Cell[112497, 2813, 1190, 31, 48, "Input",ExpressionUUID->"8c5b07b2-5971-4ed2-80b6-56815e3388a1"],
Cell[113690, 2846, 952, 25, 67, "Input",ExpressionUUID->"dfda592d-cb62-45f8-ba38-4644ceb4896f"],
Cell[114645, 2873, 757, 19, 48, "Input",ExpressionUUID->"517dd0c7-f250-410b-ba7c-9375cf12bfda"],
Cell[115405, 2894, 687, 16, 28, "Input",ExpressionUUID->"304dfec1-6788-41a6-a762-99914d810b49"],
Cell[116095, 2912, 459, 11, 48, "Input",ExpressionUUID->"49d1990d-7108-4a13-8f4c-2de92e0280f7"],
Cell[116557, 2925, 659, 18, 28, "Input",ExpressionUUID->"4465c9c6-64a1-43d9-91ed-2f1ef573bb42"],
Cell[117219, 2945, 605, 17, 28, "Input",ExpressionUUID->"2021634e-9119-4271-8112-97f7db03770c"],
Cell[117827, 2964, 821, 22, 48, "Input",ExpressionUUID->"7469f63d-8640-4876-9dd3-3e7274f3b9ed"],
Cell[118651, 2988, 999, 17, 105, "Input",ExpressionUUID->"287465f1-9254-4274-90e6-370059b82730"],
Cell[119653, 3007, 430, 11, 28, "Input",ExpressionUUID->"1c5913fc-6679-451f-aa63-2a80743d235e"],
Cell[120086, 3020, 667, 18, 28, "Input",ExpressionUUID->"bd3d567a-08ef-488b-a1e0-f27195597732"],
Cell[120756, 3040, 1122, 32, 67, "Input",ExpressionUUID->"f9459810-6c7a-47e0-86c6-a167563867db"],
Cell[121881, 3074, 660, 15, 86, "Input",ExpressionUUID->"108e5279-c0c6-44d0-8e6e-12e3652af963"],
Cell[122544, 3091, 1932, 45, 105, "Input",ExpressionUUID->"560b720b-7a66-47fd-8d2e-0f12a0bcbb07"],
Cell[124479, 3138, 624, 15, 28, "Input",ExpressionUUID->"6a59e213-54b6-4ab5-bc13-c4f515ca401b"],
Cell[125106, 3155, 1554, 45, 67, "Input",ExpressionUUID->"dd229eab-54e1-44e5-85e5-0ba058cdddb4"],
Cell[126663, 3202, 3871, 95, 219, "Input",ExpressionUUID->"ed78f8bb-e4d2-4a29-83c5-1b2f4aacc7f0"],
Cell[130537, 3299, 307, 7, 28, "Input",ExpressionUUID->"3f109a5f-0b4c-4ead-a11a-0bddef6f77b6"],
Cell[130847, 3308, 1745, 47, 162, "Input",ExpressionUUID->"d6e31370-efb0-4a82-b080-b7a0be5f461a"],
Cell[132595, 3357, 2673, 74, 238, "Input",ExpressionUUID->"fccc4dff-4655-4ae9-b8d8-80a79c8f740c"]
}
]
*)

